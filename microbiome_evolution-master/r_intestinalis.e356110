Loading sample metadata...
Done!
Loading pre-computed substitution rates for Roseburia_intestinalis_56239...
Calculating matrix...
Done!
Clustering samples with low divergence...
Top level: 2 clades, [20  0]
Max: 20
Continuing with 20 samples...
Re-loading Roseburia_intestinalis_56239...
Loading core genes...
Done! Core genome consists of 2409 genes
Loading chunk starting @ 0...
1k sites processed...
2k sites processed...
3k sites processed...
4k sites processed...
5k sites processed...
6k sites processed...
7k sites processed...
8k sites processed...
9k sites processed...
10k sites processed...
11k sites processed...
12k sites processed...
13k sites processed...
14k sites processed...
15k sites processed...
16k sites processed...
17k sites processed...
18k sites processed...
19k sites processed...
20k sites processed...
21k sites processed...
22k sites processed...
23k sites processed...
24k sites processed...
25k sites processed...
26k sites processed...
27k sites processed...
28k sites processed...
29k sites processed...
30k sites processed...
31k sites processed...
32k sites processed...
33k sites processed...
34k sites processed...
35k sites processed...
36k sites processed...
37k sites processed...
38k sites processed...
39k sites processed...
40k sites processed...
41k sites processed...
42k sites processed...
43k sites processed...
44k sites processed...
45k sites processed...
46k sites processed...
47k sites processed...
48k sites processed...
49k sites processed...
50k sites processed...
51k sites processed...
52k sites processed...
53k sites processed...
54k sites processed...
55k sites processed...
56k sites processed...
57k sites processed...
58k sites processed...
59k sites processed...
60k sites processed...
61k sites processed...
Done! Loaded 2409 genes
Calculating matrix of snp differences...
Done!
Calculating matrix of 4D differences...
Done!
Calculating matrix of 1D differences...
Done!
Calculating the SFS...
Traceback (most recent call last):
  File "plot_within_clade_sfs.py", line 308, in <module>
    chunk_synonymous_freqs = diversity_utils.calculate_pooled_freqs(allele_counts_map, passed_sites_map, allowed_variant_types = set(['4D']), allowed_genes=core_genes)
  File "/u/project/ngarud/jonmah/demo_for_ccgb/microbiome_evolution-master/diversity_utils.py", line 581, in calculate_pooled_freqs
    allowed_sample_idxs = numpy.array([True for i in xrange(0,allele_counts_map.values()[0].values()[0]['alleles'].shape[1])])
IndexError: tuple index out of range
