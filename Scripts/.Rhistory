compare_hmp_sfs(p_merdae_hmp_qp_syn, one_epoch_14, p_merdae_core_two_epoch, p_merdae_core_three_epoch, p_merdae_hmp_qp_nonsyn, p_merdae_core_gamma_dfe, p_merdae_core_neugamma_dfe) + ggtitle('P. merdae (Core genes, downsampled to 14)')
compare_hmp_sfs(phascolarctobacterium_sp_hmp_qp_syn, one_epoch_14, phascolarctobacterium_sp_core_two_epoch, phascolarctobacterium_sp_core_three_epoch, phascolarctobacterium_sp_hmp_qp_nonsyn, phascolarctobacterium_sp_core_gamma_dfe, phascolarctobacterium_sp_core_neugamma_dfe) + ggtitle('Phascolarctobacterium sp. (Core genes, downsampled to 14)')
compare_hmp_sfs(p_copri_hmp_qp_syn, one_epoch_14, p_copri_core_two_epoch, p_copri_core_three_epoch, p_copri_hmp_qp_nonsyn, p_copri_core_gamma_dfe, p_copri_core_neugamma_dfe) + ggtitle('P. copri (Core genes, downsampled to 14)')
compare_hmp_sfs(r_bicirculans_hmp_qp_syn, one_epoch_14, r_bicirculans_core_two_epoch, r_bicirculans_core_three_epoch, r_bicirculans_hmp_qp_nonsyn, r_bicirculans_core_gamma_dfe, r_bicirculans_core_neugamma_dfe) + ggtitle('R. bicirculans (Core genes, downsampled to 14)')
compare_hmp_sfs(r_bromii_hmp_qp_syn, one_epoch_14, r_bromii_core_two_epoch, r_bromii_core_three_epoch, r_bromii_hmp_qp_nonsyn, r_bromii_core_gamma_dfe, r_bromii_core_neugamma_dfe) + ggtitle('R. bromii (Core genes, downsampled to 14)')
dfe_dadi_df = rbind(
melt(a_muciniphila_dfe_dadi_params),
melt(a_finegoldii_dfe_dadi_params),
melt(a_onderdonkii_dfe_dadi_params),
melt(a_putredinis_dfe_dadi_params),
melt(a_shahii_dfe_dadi_params),
melt(b_bacterium_dfe_dadi_params),
melt(b_caccae_dfe_dadi_params),
melt(b_cellulosilyticus_dfe_dadi_params),
melt(b_fragilis_dfe_dadi_params),
# melt(b_ovatus_dfe_dadi_params),
melt(b_stercoris_dfe_dadi_params),
melt(b_thetaiotaomicron_dfe_dadi_params),
melt(b_uniformis_dfe_dadi_params),
melt(b_vulgatus_dfe_dadi_params),
melt(b_xylanisolvens_dfe_dadi_params),
melt(b_intestinihominis_dfe_dadi_params),
melt(d_invisus_dfe_dadi_params),
melt(e_eligens_dfe_dadi_params),
melt(e_rectale_dfe_dadi_params),
melt(f_prausnitzii_dfe_dadi_params),
melt(o_splanchnicus_dfe_dadi_params),
melt(oscillibacter_sp_dfe_dadi_params),
melt(p_distasonis_dfe_dadi_params),
melt(p_merdae_dfe_dadi_params),
melt(phascolarctobacterium_sp_dfe_dadi_params),
melt(p_copri_dfe_dadi_params),
melt(r_bicirculans_dfe_dadi_params),
melt(r_bromii_dfe_dadi_params)
)
phylogenetic_levels = c(
'Bacteroidales bacterium',
'Alistipes putredinis',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes shahii',
'Odoribacter splanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Bacteroides fragilis',
'Bacteroides cellulosilyticus',
'Bacteroides stercoris',
'Bacteroides uniformis',
'Bacteroides thetaiotaomicron',
# 'Bacteroides ovatus',
'Bacteroides xylanisolvens',
'Bacteroides caccae',
# 'Bacteroides massiliensis',
'Bacteroides vulgatus',
'Barnesiella intestinihominis',
'Akkermansia muciniphila',
'Dialister invisus',
'Phascolarctobacterium species',
'Eubacterium eligens',
'Eubacterium rectale',
# 'Coprococcus species',
'Oscillibacter species',
'Ruminococcus bromii',
'Ruminococcus bicirculans',
'Faecalibacterium prausnitzii'
)
dfe_df$species = factor(dfe_df$species, levels=phylogenetic_levels)
dfe_dadi_df$species = factor(dfe_dadi_df$species, levels=phylogenetic_levels)
# dfe_df$value = dfe_df$value * 2
dfe_df$value[dfe_df$value <= 1e-11] = 1e-11
dfe_df$value[dfe_df$value >= 0.5] = 0.5
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 1) +
#labs(
#  title = 'Gamma-Distributed DFE',
#  subtitle = 'Assuming a mutation rate of mu=4.08E-10'
#) +
theme_ridges() +
scale_x_log10(limits=c(1e-12, 1e1)) +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
#labs(
#  title = 'Gamma-Distributed DFE',
#  subtitle = 'Selective effect multiplied by N_anc'
#) +
theme_ridges() +
scale_x_log10() +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
dfe_dadi_df$value[dfe_dadi_df$value <= 1e-1] = 1e-1
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
#labs(
#  title = 'Gamma-Distributed DFE',
#  subtitle = 'Selective effect multiplied by N_anc'
#) +
theme_ridges() +
scale_x_log10() +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
#labs(
#  title = 'Neutral + Gamma-Distributed DFE',
#  subtitle = 'Assuming a mutation rate of mu=4.08E-10'
#) +
theme_ridges() +
scale_x_log10(limits=c(1e-12, 1e1)) +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
dfe_dadi_df$value[dfe_dadi_df$value <= 1e-1] = 1e-1
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
#labs(
#  title = 'Gamma-Distributed DFE',
#  subtitle = 'Selective effect multiplied by N_anc'
#) +
theme_ridges() +
scale_x_log10() +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
#labs(
#  title = 'Gamma-Distributed DFE',
#  subtitle = 'Selective effect multiplied by N_anc'
#) +
theme_ridges() +
scale_x_log10() +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'neugamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
#labs(
#  title = 'Neutral + Gamma-Distributed DFE',
#  subtitle = 'Selective effect multiplied by 2N_anc'
#) +
theme_ridges() +
scale_x_log10() +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 1) +
#labs(
#  title = 'Gamma-Distributed DFE',
#  subtitle = 'Assuming a mutation rate of mu=4.08E-10'
#) +
theme_ridges() +
scale_x_log10(limits=c(1e-12, 1e1)) +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
weakly_deleterious_s =  1E-6
moderately_deleterious_s = 1E-2
lethal_s = 0.99
DFE_cutoffs = c(-Inf, 1e-7, 1e-6, 1e-5, 1e-4, 1e-3, 1e-2, 1e-1, Inf)
a_muciniphila_gamma_dfe = a_muciniphila_dfe_df[a_muciniphila_dfe_df$variable=='Gamma-Distributed DFE', ]
r_bromii_gamma_dfe = r_bromii_dfe_df[r_bromii_dfe_df$variable=='Gamma-Distributed DFE', ]
a_muciniphila_gamma_dfe[a_muciniphila_gamma_dfe$value < 1e-13, ]= 1e-13
a_muciniphila_gamma_dfe[a_muciniphila_gamma_dfe$value > 1e2, ]= 1e2
a_muciniphila_gamma_dfe_bins = cut(a_muciniphila_gamma_dfe$value, breaks=DFE_cutoffs)
r_bromii_gamma_dfe[r_bromii_gamma_dfe$value < 1e-13, ]= 1e-13
r_bromii_gamma_dfe[r_bromii_gamma_dfe$value > 1e2, ]= 1e2
r_bromii_gamma_dfe_bins = cut(r_bromii_gamma_dfe$value, breaks=DFE_cutoffs)
a_muciniphila_weakly_deleterious = mean(a_muciniphila_gamma_dfe$value < weakly_deleterious_s)
a_muciniphila_weakly_deleterious
a_muciniphila_moderately_deleterious =  mean(weakly_deleterious_s < a_muciniphila_gamma_dfe$value & a_muciniphila_gamma_dfe$value < moderately_deleterious_s)
a_muciniphila_moderately_deleterious
a_muciniphila_highly_deleterious = mean(moderately_deleterious_s < a_muciniphila_gamma_dfe$value & a_muciniphila_gamma_dfe$value < lethal_s)
a_muciniphila_highly_deleterious
a_muciniphila_lethal = mean(a_muciniphila_gamma_dfe$value > lethal_s)
a_muciniphila_lethal
r_bromii_weakly_deleterious = mean(r_bromii_gamma_dfe$value < weakly_deleterious_s)
r_bromii_weakly_deleterious
r_bromii_moderately_deleterious =  mean(weakly_deleterious_s < r_bromii_gamma_dfe$value & r_bromii_gamma_dfe$value < moderately_deleterious_s)
r_bromii_moderately_deleterious
r_bromii_highly_deleterious = mean(moderately_deleterious_s < r_bromii_gamma_dfe$value & r_bromii_gamma_dfe$value < lethal_s)
r_bromii_highly_deleterious
r_bromii_lethal = mean(r_bromii_gamma_dfe$value > lethal_s)
r_bromii_lethal
weakly_deleterious_s =  1E-6
moderately_deleterious_s = 1E-2
lethal_s = 0.5
DFE_cutoffs = c(-Inf, 1e-7, 1e-6, 1e-5, 1e-4, 1e-3, 1e-2, 1e-1, Inf)
a_muciniphila_gamma_dfe = a_muciniphila_dfe_df[a_muciniphila_dfe_df$variable=='Gamma-Distributed DFE', ]
r_bromii_gamma_dfe = r_bromii_dfe_df[r_bromii_dfe_df$variable=='Gamma-Distributed DFE', ]
a_muciniphila_gamma_dfe[a_muciniphila_gamma_dfe$value < 1e-13, ]= 1e-13
a_muciniphila_gamma_dfe[a_muciniphila_gamma_dfe$value > 1e2, ]= 1e2
a_muciniphila_gamma_dfe_bins = cut(a_muciniphila_gamma_dfe$value, breaks=DFE_cutoffs)
r_bromii_gamma_dfe[r_bromii_gamma_dfe$value < 1e-13, ]= 1e-13
r_bromii_gamma_dfe[r_bromii_gamma_dfe$value > 1e2, ]= 1e2
r_bromii_gamma_dfe_bins = cut(r_bromii_gamma_dfe$value, breaks=DFE_cutoffs)
a_muciniphila_weakly_deleterious = mean(a_muciniphila_gamma_dfe$value < weakly_deleterious_s)
a_muciniphila_weakly_deleterious
a_muciniphila_moderately_deleterious =  mean(weakly_deleterious_s < a_muciniphila_gamma_dfe$value & a_muciniphila_gamma_dfe$value < moderately_deleterious_s)
a_muciniphila_moderately_deleterious
a_muciniphila_highly_deleterious = mean(moderately_deleterious_s < a_muciniphila_gamma_dfe$value & a_muciniphila_gamma_dfe$value < lethal_s)
a_muciniphila_highly_deleterious
a_muciniphila_lethal = mean(a_muciniphila_gamma_dfe$value > lethal_s)
a_muciniphila_lethal
r_bromii_weakly_deleterious = mean(r_bromii_gamma_dfe$value < weakly_deleterious_s)
r_bromii_weakly_deleterious
r_bromii_moderately_deleterious =  mean(weakly_deleterious_s < r_bromii_gamma_dfe$value & r_bromii_gamma_dfe$value < moderately_deleterious_s)
r_bromii_moderately_deleterious
r_bromii_highly_deleterious = mean(moderately_deleterious_s < r_bromii_gamma_dfe$value & r_bromii_gamma_dfe$value < lethal_s)
r_bromii_highly_deleterious
r_bromii_lethal = mean(r_bromii_gamma_dfe$value > lethal_s)
r_bromii_lethal
DFE_grid_file_list = c(
'../Analysis/cross_species_dfe/Bacteroidales_bacterium_58650_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_onderdonkii_55464_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_shahii_62199_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Odoribacter_splanchnicus_62174_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_distasonis_56985_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_merdae_56972_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Prevotella_copri_61740_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_fragilis_54507_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_stercoris_56735_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_vulgatus_57955_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Barnesiella_intestinihominis_62208_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Phascolarctobacterium_sp_59817_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_eligens_61678_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_rectale_56927_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Oscillibacter_sp_60799_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bromii_62047_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bicirculans_59300_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_likelihood_surface.csv')
length(DFE_grid_file_list)
DFE_grid_file_list = c(
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_onderdonkii_55464_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_putredinis_61533_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_shahii_62199_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroidales_bacterium_58650_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_caccae_53434_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_fragilis_54507_likelihood_surface.csv',
# '../Analysis/cross_species_dfe/Bacteroides_ovatus_58035_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_stercoris_56735_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_uniformis_57318_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_vulgatus_57955_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Barnesiella_intestinihominis_62208_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Dialister_invisus_61905_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_eligens_61678_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_rectale_56927_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Odoribacter_splanchnicus_62174_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Oscillibacter_sp_60799_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_distasonis_56985_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_merdae_56972_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Phascolarctobacterium_sp_59817_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Prevotella_copri_61740_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bicirculans_59300_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bromii_62047_likelihood_surface.csv'
)
length(DFE_grid_file_list)
for (species in DFE_grid_file_list) {
print(species)
find_dfe_mle(species)
}
# test
cross_species_dfe_comparison(
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv')
for (i in 1:27) {
for (j in 1:27) {
print(DFE_grid_file_list[i])
print(DFE_grid_file_list[j])
comparison = cross_species_dfe_comparison(DFE_grid_file_list[i], DFE_grid_file_list[j])
print(comparison)
dfe_comparison_matrix[i, j] = comparison
}
}
dfe_comparison_matrix
length(phylogenetic_levels)
row.names(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
write.csv(dfe_comparison_matrix, '../Analysis/cross_species_dfe/dfe_comparison_matrix.csv')
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv',
header=TRUE)
pheatmap(dfe_comparison_matrix,
cluster_rows = F, cluster_cols = F, fontsize_number = 10,
display_numbers = T,
show_colnames     = FALSE,
show_rownames     = FALSE,
color = colorRampPalette(c('red','orange', 'yellow', 'white'), bias=0.05)(100),
legend=TRUE)
dfe_comparison_matrix
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv',
header=TRUE)
dfe_comparison_matrix = dfe_comparison_matrix[, -1]
rownames(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
pheatmap(dfe_comparison_matrix,
cluster_rows = F, cluster_cols = F, fontsize_number = 10,
display_numbers = T,
show_colnames     = FALSE,
show_rownames     = FALSE,
color = colorRampPalette(c('red','orange', 'yellow', 'white'), bias=0.05)(100),
legend=TRUE)
dfe_dadi_df = rbind(
melt(a_muciniphila_dfe_dadi_params),
melt(a_finegoldii_dfe_dadi_params),
melt(a_onderdonkii_dfe_dadi_params),
melt(a_putredinis_dfe_dadi_params),
melt(a_shahii_dfe_dadi_params),
melt(b_bacterium_dfe_dadi_params),
melt(b_caccae_dfe_dadi_params),
melt(b_cellulosilyticus_dfe_dadi_params),
melt(b_fragilis_dfe_dadi_params),
# melt(b_ovatus_dfe_dadi_params),
melt(b_stercoris_dfe_dadi_params),
melt(b_thetaiotaomicron_dfe_dadi_params),
melt(b_uniformis_dfe_dadi_params),
melt(b_vulgatus_dfe_dadi_params),
melt(b_xylanisolvens_dfe_dadi_params),
melt(b_intestinihominis_dfe_dadi_params),
melt(d_invisus_dfe_dadi_params),
melt(e_eligens_dfe_dadi_params),
melt(e_rectale_dfe_dadi_params),
melt(f_prausnitzii_dfe_dadi_params),
melt(o_splanchnicus_dfe_dadi_params),
melt(oscillibacter_sp_dfe_dadi_params),
melt(p_distasonis_dfe_dadi_params),
melt(p_merdae_dfe_dadi_params),
melt(phascolarctobacterium_sp_dfe_dadi_params),
melt(p_copri_dfe_dadi_params),
melt(r_bicirculans_dfe_dadi_params),
melt(r_bromii_dfe_dadi_params)
)
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 1) +
#labs(
#  title = 'Gamma-Distributed DFE',
#  subtitle = 'Assuming a mutation rate of mu=4.08E-10'
#) +
theme_ridges() +
scale_x_log10(limits=c(1e-12, 1e1)) +
ylab('Proportion of Sites') +
theme(axis.text.y = element_text(face='italic')) +
theme(axis.text.y = element_text(hjust=0)) +
theme(legend.position = "none") +
xlab('Selection Coefficient')
one_epoch_file_list = c(
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_one_epoch_demography.txt',
# '../Analysis/Bacteroides_ovatus_58035_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_one_epoch_demography.txt'
)
two_epoch_file_list = c(
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_two_epoch_demography.txt',
# '../Analysis/Bacteroides_ovatus_58035_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_two_epoch_demography.txt'
)
three_epoch_file_list = c(
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_three_epoch_demography.txt',
# '../Analysis/Bacteroides_ovatus_58035_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_three_epoch_demography.txt'
)
species_list = c(
'Akkermansia_muciniphila_55290',
'Alistipes_finegoldii_56071',
'Alistipes_onderdonkii_55464',
'Alistipes_putredinis_61533',
'Alistipes_shahii_62199',
'Bacteroidales_bacterium_58650',
'Bacteroides_caccae_53434',
'Bacteroides_cellulosilyticus_58046',
'Bacteroides_fragilis_54507',
# 'Bacteroides_ovatus_58035',
'Bacteroides_stercoris_56735',
'Bacteroides_thetaiotaomicron_56941',
'Bacteroides_uniformis_57318',
'Bacteroides_vulgatus_57955',
'Bacteroides_xylanisolvens_57185',
'Barnesiella_intestinihominis_62208',
'Dialister_invisus_61905',
'Eubacterium_eligens_61678',
'Eubacterium_rectale_56927',
'Faecalibacterium_prausnitzii_57453',
'Odoribacter_splanchnicus_62174',
'Oscillibacter_sp_60799',
'Parabacteroides_distasonis_56985',
'Parabacteroides_merdae_56972',
'Phascolarctobacterium_sp_59817',
'Prevotella_copri_61740',
'Ruminococcus_bicirculans_59300',
'Ruminococcus_bromii_62047'
)
AIC_matrix = data.frame(
one_epoch = numeric(27),
two_epoch = numeric(27),
three_epoch = numeric(27),
delta_AIC = numeric(27))
row.names(AIC_matrix) = species_list
for (i in 1:length(species_list)) {
AIC_matrix[i, 1] = AIC_from_demography(one_epoch_file_list[i])
AIC_matrix[i, 2] = AIC_from_demography(two_epoch_file_list[i])
AIC_matrix[i, 3] = AIC_from_demography(three_epoch_file_list[i])
AIC_matrix[i, 4] = abs(min(AIC_matrix[i, 1], AIC_matrix[i, 3]) - AIC_matrix[i, 2])
}
AIC_matrix
