input_file
read_input_sfs(input_file)
read_input_sfs = function(input_file)  {
this_file = file(input_file)
sfs_string = readLines(this_file)[2]
output_sfs = as.numeric(unlist(strsplit(sfs_string, ' ')))
return(output_sfs)
}
read_input_sfs(input_file)
fold_sfs(read_input_sfs(input_file))
output_sfs = read_input_sfs(input_file)
output_sfs[1:]
output_sfs[1]
output_sfs[2:]
output_sfs[:]
output_sfs[-1]
output_sfs
output_sfs[-2]
read_input_sfs = function(input_file)  {
this_file = file(input_file)
sfs_string = readLines(this_file)[2]
output_sfs = as.numeric(unlist(strsplit(sfs_string, ' ')))
output_sfs = output_sfs[-1] # Remove 0-tons
return(output_sfs)
}
read_input_sfs(input_file)
fold_sfs(read_input_sfs(input_file))
read_input_sfs = function(input_file)  {
this_file = file(input_file)
sfs_string = readLines(this_file)[2]
output_sfs = as.numeric(unlist(strsplit(sfs_string, ' ')))
output_sfs = output_sfs[-1] # Remove 0-tons
output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
read_input_sfs(input_file)
input_file = '../Analysis/Alistipes_finegoldii_56071_downsampled/exponential_growth_demography.txt'
input_file = '../Analysis/Alistipes_finegoldii_56071_downsampled/exponential_growth_demography.txt'
file(input_file)
readLines(file(input_file))
readLines(file(input_file))[7]
temp = readLines(file(input_file))[7]
temp
strsplit(temp, '[-- ')
strsplit(temp, '-- ')
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[2]
output_sfs = strsplit(output_sfs, ' --')[1]
return(output_sfs)
}
sfs_from_demography(input_file)
return(output_sfs)
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[2]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
output_sfs = strsplit(sfs_string, '-- ')
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[[2]]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[2]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[1]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[1][2]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[1][1]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[2]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')[1]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography(input_file)[2]
sfs_from_demography(input_file)[1]
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)[1]
sfs_from_demography(input_file)
sfs_from_demography(input_file)[1, ]
sfs_from_demography(input_file)[1]
sfs_from_demography(input_file)[2]
sfs_from_demography(input_file)[3]
sfs_from_demography(input_file)[1]
sfs_from_demography(input_file)[1][1]
sfs_from_demography(input_file)[1][2]
sfs_from_demography(input_file)[1][1]
sfs_from_demography(input_file)[1][1][1]
sfs_from_demography(input_file)[1][1][1][1]
sfs_from_demography(input_file)
typeof(sfs_from_demography(input_file))
sfs_from_demography(input_file)[-1]
sfs_from_demography(input_file)[-0]
sfs_from_demography(input_file)
sfs_from_demography(input_file)
unlist(sfs_from_demography(input_file))
unlist(sfs_from_demography(input_file))[2]
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = as.numeric(unlist(output_sfs)[2])
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = as.numeric(unlist(output_sfs)[2])
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
# output_sfs = as.numeric(unlist(output_sfs)[2])
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
as.numeric(sfs_from_demography(input_file))
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = as.numeric(unlist(strsplit(output_sfs, ' ')))
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = strsplit(output_sfs, ' ')
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
?length
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = strsplit(output_sfs, ' ')
output_sfs = output_sfs[-length(output_sfs)]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = strsplit(output_sfs, ' ')
# output_sfs = output_sfs[-length(output_sfs)]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
# output_sfs = output_sfs[-length(output_sfs)]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
# output_sfs = strsplit(output_sfs, ' --')
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
sfs_from_demography(input_file)
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
# output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
sfs_from_demography(input_file)
length(sfs_from_demography)
length(sfs_from_demography(input_file))
fold_sfs = function(input_sfs) {
input_length = length(input_sfs)
folded_length = length(input_sfs) / 2
if (input_length %% 2 == 1) {
folded_length = folded_length + 1
}
output_sfs = c()
for (i in 1:folded_length) {
if (input_sfs[i] == input_sfs[input_length - i + 1]) {
output_sfs[i] = input_sfs[i]
} else {
output_sfs[i] = input_sfs[i] + input_sfs[input_length - i + 1]
}
}
return(output_sfs)
}
proportional_sfs = function(input_sfs) {
input_sfs[1] = 0
return (input_sfs / sum(input_sfs))
}
read_input_sfs = function(input_file)  {
this_file = file(input_file)
sfs_string = readLines(this_file)[2]
output_sfs = as.numeric(unlist(strsplit(sfs_string, ' ')))
output_sfs = output_sfs[-1] # Remove 0-tons
output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
sfs_from_demography = function(input_file) {
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
# output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
sfs_from_demography(input_file)
fold_sfs(sfs_from_demography(input_file))
length(sfs_from_demography(input_file))
length(fold_sfs(sfs_from_demography(input_file)))
sfs_from_demography = function(input_file) {
# Reads input SFS from output *demography.txt
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
# Test for R. bicirculans (downsampled to 10)
r_bicirculans_downsampled_10_empirical = read_input_sfs(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/empirical_sfs.txt'
)
r_bicirculans_downsampled_10_one_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/one_epoch_demography.txt'
)
r_bicirculans_downsampled_10_two_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/two_epoch_demography.txt'
)
fold_sfs = function(input_sfs) {
input_length = length(input_sfs)
folded_length = length(input_sfs) / 2
if (input_length %% 2 == 1) {
folded_length = folded_length + 1
}
output_sfs = c()
for (i in 1:folded_length) {
if (input_sfs[i] == input_sfs[input_length - i + 1]) {
output_sfs[i] = input_sfs[i]
} else {
output_sfs[i] = input_sfs[i] + input_sfs[input_length - i + 1]
}
}
return(output_sfs)
}
proportional_sfs = function(input_sfs) {
input_sfs[1] = 0
return (input_sfs / sum(input_sfs))
}
read_input_sfs = function(input_file)  {
# Reads input SFS in Dadi Format
this_file = file(input_file)
sfs_string = readLines(this_file)[2]
output_sfs = as.numeric(unlist(strsplit(sfs_string, ' ')))
output_sfs = output_sfs[-1] # Remove 0-tons
output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
sfs_from_demography = function(input_file) {
# Reads input SFS from output *demography.txt
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Test for R. bicirculans (downsampled to 10)
r_bicirculans_downsampled_10_empirical = read_input_sfs(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/empirical_sfs.txt'
)
r_bicirculans_downsampled_10_one_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/one_epoch_demography.txt'
)
r_bicirculans_downsampled_10_two_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/two_epoch_demography.txt'
)
r_birculans_downsampled_10_one_epoch
r_bicirculans_downsampled_10_empirical
r_bicirculans_downsampled_10_one_epoch
sfs_from_demography = function(input_file) {
# Reads input SFS from output *demography.txt
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
# output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Test for R. bicirculans (downsampled to 10)
r_bicirculans_downsampled_10_empirical = read_input_sfs(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/empirical_sfs.txt'
)
r_bicirculans_downsampled_10_one_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/one_epoch_demography.txt'
)
r_bicirculans_downsampled_10_two_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/two_epoch_demography.txt'
)
r_bicirculans_downsampled_10_two_epoch
sfs_from_demography = function(input_file) {
# Reads input SFS from output *demography.txt
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
# output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
# output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Test for R. bicirculans (downsampled to 10)
r_bicirculans_downsampled_10_empirical = read_input_sfs(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/empirical_sfs.txt'
)
r_bicirculans_downsampled_10_one_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/one_epoch_demography.txt'
)
r_bicirculans_downsampled_10_two_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/two_epoch_demography.txt'
)
r_bicirulans-downsampled_10_two_epoch
r_bicirculans_downsampled_10_one_epoch
r_bicirculans_downsampled_10_empirical
sfs_from_demography = function(input_file) {
# Reads input SFS from output *demography.txt
this_file = file(input_file)
sfs_string = readLines(this_file)[7]
output_sfs = strsplit(sfs_string, '-- ')
output_sfs = unlist(output_sfs)[2]
output_sfs = unlist(strsplit(output_sfs, ' '))
output_sfs = output_sfs[-length(output_sfs)]
# output_sfs = output_sfs[-1]
output_sfs = as.numeric(output_sfs)
output_sfs = fold_sfs(output_sfs)
return(output_sfs)
}
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Test for R. bicirculans (downsampled to 10)
r_bicirculans_downsampled_10_empirical = read_input_sfs(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/empirical_sfs.txt'
)
r_bicirculans_downsampled_10_one_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/one_epoch_demography.txt'
)
r_bicirculans_downsampled_10_two_epoch = sfs_from_demography(
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_10/two_epoch_demography.txt'
)
r_bicirculans_downsampled_10_empirical
r_bicirculans_downsampled_10_empirical
r_bicirculans_downsampled_10_one_epoch
r_bicirculans_downsampled_10_two_epoch
