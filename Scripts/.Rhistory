scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect') +
scale_fill_manual(values=c("goldenrod1", "yellow2"))
e_eligens_dfe_df = melt(e_eligens_dfe_params)
# e_eligens_dfe_df$value = e_eligens_dfe_df$value * 2
e_eligens_dfe_df$value[e_eligens_dfe_df$value <= 1e-12] = 1e-12
e_eligens_dfe_df$value[e_eligens_dfe_df$value >= 1] = 1
# e_eligens_dfe_df = e_eligens_dfe_df[e_eligens_dfe_df$variable == 'gamma_dfe_dist_low' || e_eligens_dfe_df$variable == 'neugamma_dfe_dist_low', ]
e_eligens_dfe_df = rbind(
e_eligens_dfe_df[e_eligens_dfe_df$variable == 'gamma_dfe_dist_low', ],
e_eligens_dfe_df[e_eligens_dfe_df$variable == 'neugamma_dfe_dist_low',])
e_eligens_dfe_df$variable <- as.character(e_eligens_dfe_df$variable)
e_eligens_dfe_df$variable[e_eligens_dfe_df$variable == 'neugamma_dfe_dist_low'] <- 'Neutral + Gamma-Distributed DFE'
e_eligens_dfe_df$variable[e_eligens_dfe_df$variable == 'gamma_dfe_dist_low'] <- 'Gamma-Distributed DFE'
e_eligens_dfe_figure = ggplot(e_eligens_dfe_df, aes(x=value, y=fct_rev(variable), fill=variable)) +
geom_density_ridges2(aes(fill = variable), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Eubacterium eligens DFE Comparison',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect') +
scale_fill_manual(values=c("goldenrod1", "yellow2"))
b_cellulosilyticus_dfe_df = melt(b_cellulosilyticus_dfe_params)
b_cellulosilyticus_dfe_df$value[b_cellulosilyticus_dfe_df$value <= 1e-12] = 1e-12
b_cellulosilyticus_dfe_df$value[b_cellulosilyticus_dfe_df$value >= 1] = 1
# b_cellulosilyticus_dfe_df = b_cellulosilyticus_dfe_df[b_cellulosilyticus_dfe_df$variable == 'gamma_dfe_dist_low' || b_cellulosilyticus_dfe_df$variable == 'neugamma_dfe_dist_low', ]
b_cellulosilyticus_dfe_df = rbind(
b_cellulosilyticus_dfe_df[b_cellulosilyticus_dfe_df$variable == 'gamma_dfe_dist_low', ],
b_cellulosilyticus_dfe_df[b_cellulosilyticus_dfe_df$variable == 'neugamma_dfe_dist_low',])
b_cellulosilyticus_dfe_df$variable <- as.character(b_cellulosilyticus_dfe_df$variable)
b_cellulosilyticus_dfe_df$variable[b_cellulosilyticus_dfe_df$variable == 'neugamma_dfe_dist_low'] <- 'Neutral + Gamma-Distributed DFE'
b_cellulosilyticus_dfe_df$variable[b_cellulosilyticus_dfe_df$variable == 'gamma_dfe_dist_low'] <- 'Gamma-Distributed DFE'
b_cellulosilyticus_dfe_figure = ggplot(b_cellulosilyticus_dfe_df, aes(x=value, y=fct_rev(variable), fill=variable)) +
geom_density_ridges2(aes(fill = variable), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Bacteroides cellulosilyticus DFE Comparison',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect') +
scale_fill_manual(values=c("goldenrod1", "yellow2"))
o_splanchnicus_dfe_figure + e_eligens_dfe_figure + b_cellulosilyticus_dfe_figure + plot_layout(ncol = 1)
two_epoch_nu_tau = read.csv('../Summary/two_epoch_demography_interpretation.csv')
three_epoch_nu_tau= read.csv('../Summary/three_epoch_demography_interpretation.csv')
two_epoch_nu_tau = two_epoch_nu_tau[-12, ]
two_epoch_nu_tau = two_epoch_nu_tau[-6, ]
three_epoch_nu_tau = three_epoch_nu_tau[-5, ]
two_epoch_nu_tau$demography = 'Two Epoch'
three_epoch_nu_tau$demography = 'Three Epoch'
three_epoch_nu_tau = cbind(three_epoch_nu_tau$species, three_epoch_nu_tau$nu_f, three_epoch_nu_tau$time_total_low, three_epoch_nu_tau$time_total_high, three_epoch_nu_tau$demography)
colnames(three_epoch_nu_tau) = c('species', 'nu', 'time_low', 'time_high', 'demography')
demography_df =  rbind(two_epoch_nu_tau, three_epoch_nu_tau)
demography_df$time_low = as.numeric(demography_df$time_low)
demography_df$nu = as.numeric(demography_df$nu)
demography_df$species = factor(demography_df$species, levels=phylogenetic_levels)
demography_df_highlight = demography_df[demography_df$species %in% c('Odoribacter splanchnicus', 'Eubacterium eligens', 'Bacteroides cellulosilyticus'), ]
ggscatter(demography_df, x="nu", y="time_low", color="species", shape='demography', size=3) + geom_vline(xintercept=1) +
ylab('Estimated Time in Years') +
xlab('Ratio of current to ancestral population size') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
theme(legend.position="right") +
geom_text_repel(aes(label = demography_df$species, color=demography_df$species)) +
guides(color=guide_legend(title="Species")) +
scale_x_log10(limits=c(1e-1, 1e1)) +
scale_y_log10(limits=c(1e1, 1e7)) +
theme(legend.title = element_text(size=30)) +
theme(legend.text = element_text(size=12)) +
guides(color = 'none') +
guides(shape = 'none')  +
geom_point(data=demography_df_highlight, color='red', shape=1, size=6) +
# geom_point(data=demography_df_highlight, aes(x=nu, y=time_low, color='red', shape=1, size=4))  +
ggtitle('Commensal Gut Microbiota have Varied Demographic Histories') +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=16,face="bold"))
# Full empirical SFS
plot_original_empirical_sfs(b_vulgatus_no_clade_control) + ggtitle('B. vulgatus full empirical SFS (unfolded with no Clade Control)') +
scale_x_continuous() +
guides(color = 'none', size = 'none', fill = 'none') +
ggtitle('Bacteroides vulgatus empirical Site-frequency Spectrum') +
xlab('Allele Frequency')
compare_hmp_sfs(b_cellulosilyticus_hmp_qp_syn, one_epoch_14, b_cellulosilyticus_complete_two_epoch, b_cellulosilyticus_complete_three_epoch, b_cellulosilyticus_hmp_qp_nonsyn, b_cellulosilyticus_complete_gamma_dfe, b_cellulosilyticus_complete_neugamma_dfe) + ggtitle('B. cellulosilyticus (Downsampled to 14)')
compare_hmp_sfs(e_eligens_hmp_qp_syn, one_epoch_14, e_eligens_complete_two_epoch, e_eligens_complete_three_epoch, e_eligens_hmp_qp_nonsyn, e_eligens_complete_gamma_dfe, e_eligens_complete_neugamma_dfe) + ggtitle('E. eligens (Downsampled to 14)')
compare_hmp_sfs(b_ovatus_hmp_qp_syn, one_epoch_14, b_ovatus_complete_two_epoch, b_ovatus_complete_three_epoch, b_ovatus_hmp_qp_nonsyn, b_ovatus_complete_gamma_dfe, b_ovatus_complete_neugamma_dfe) + ggtitle('B. ovatus (Downsampled to 14)')
x_axis = 1:length(one_epoch_14)
a_muciniphila_best_fit = cbind(
proportional_sfs(a_muciniphila_hmp_qp_syn[-1]),
proportional_sfs(a_muciniphila_complete_two_epoch),
proportional_sfs(a_muciniphila_hmp_qp_nonsyn[-1]),
proportional_sfs(a_muciniphila_complete_gamma_dfe),
rep('A. muciniphila', length(a_muciniphila_hmp_qp_syn[-1])),
x_axis
)
a_finegoldii_best_fit = cbind(
proportional_sfs(a_finegoldii_hmp_qp_syn[-1]),
proportional_sfs(a_finegoldii_complete_two_epoch),
proportional_sfs(a_finegoldii_hmp_qp_nonsyn[-1]),
proportional_sfs(a_finegoldii_complete_gamma_dfe),
rep('A. finegoldii', length(a_finegoldii_hmp_qp_syn[-1])),
x_axis
)
a_onderdonkii_best_fit = cbind(
proportional_sfs(a_onderdonkii_hmp_qp_syn[-1]),
proportional_sfs(a_onderdonkii_complete_two_epoch),
proportional_sfs(a_onderdonkii_hmp_qp_nonsyn[-1]),
proportional_sfs(a_onderdonkii_complete_gamma_dfe),
rep('A. onderdonkii', length(a_onderdonkii_hmp_qp_syn[-1])),
x_axis
)
a_shahii_best_fit = cbind(
proportional_sfs(a_shahii_hmp_qp_syn[-1]),
proportional_sfs(a_shahii_complete_two_epoch),
proportional_sfs(a_shahii_hmp_qp_nonsyn[-1]),
proportional_sfs(a_shahii_complete_gamma_dfe),
rep('A. shahii', length(a_shahii_hmp_qp_syn[-1])),
x_axis
)
b_bacterium_best_fit = cbind(
proportional_sfs(b_bacterium_hmp_qp_syn[-1]),
proportional_sfs(b_bacterium_complete_two_epoch),
proportional_sfs(b_bacterium_hmp_qp_nonsyn[-1]),
proportional_sfs(b_bacterium_complete_gamma_dfe),
rep('B. bacterium', length(b_bacterium_hmp_qp_syn[-1])),
x_axis
)
b_cellulosilyticus_best_fit = cbind(
proportional_sfs(b_cellulosilyticus_hmp_qp_syn[-1]),
proportional_sfs(b_cellulosilyticus_complete_two_epoch),
proportional_sfs(b_cellulosilyticus_hmp_qp_nonsyn[-1]),
proportional_sfs(b_cellulosilyticus_complete_gamma_dfe),
rep('B. cellulosilyticus', length(b_cellulosilyticus_hmp_qp_syn[-1])),
x_axis
)
b_fragilis_best_fit = cbind(
proportional_sfs(b_fragilis_hmp_qp_syn[-1]),
proportional_sfs(b_fragilis_complete_two_epoch),
proportional_sfs(b_fragilis_hmp_qp_nonsyn[-1]),
proportional_sfs(b_fragilis_complete_gamma_dfe),
rep('B. fragilis', length(b_fragilis_hmp_qp_syn[-1])),
x_axis
)
b_stercoris_best_fit = cbind(
proportional_sfs(b_stercoris_hmp_qp_syn[-1]),
proportional_sfs(b_stercoris_complete_two_epoch),
proportional_sfs(b_stercoris_hmp_qp_nonsyn[-1]),
proportional_sfs(b_stercoris_complete_gamma_dfe),
rep('B. stercoris', length(b_stercoris_hmp_qp_syn[-1])),
x_axis
)
b_thetaiotaomicron_best_fit = cbind(
proportional_sfs(b_thetaiotaomicron_hmp_qp_syn[-1]),
proportional_sfs(b_thetaiotaomicron_complete_two_epoch),
proportional_sfs(b_thetaiotaomicron_hmp_qp_nonsyn[-1]),
proportional_sfs(b_thetaiotaomicron_complete_gamma_dfe),
rep('B. thetaiotaomicron', length(b_thetaiotaomicron_hmp_qp_syn[-1])),
x_axis
)
b_vulgatus_best_fit = cbind(
proportional_sfs(b_vulgatus_hmp_qp_syn[-1]),
proportional_sfs(b_vulgatus_complete_two_epoch),
proportional_sfs(b_vulgatus_hmp_qp_nonsyn[-1]),
proportional_sfs(b_vulgatus_complete_gamma_dfe),
rep('B. vulgatus', length(b_vulgatus_hmp_qp_syn[-1])),
x_axis
)
b_xylanisolvens_best_fit = cbind(
proportional_sfs(b_xylanisolvens_hmp_qp_syn[-1]),
proportional_sfs(b_xylanisolvens_complete_two_epoch),
proportional_sfs(b_xylanisolvens_hmp_qp_nonsyn[-1]),
proportional_sfs(b_xylanisolvens_complete_gamma_dfe),
rep('B. xylanisolvens', length(b_xylanisolvens_hmp_qp_syn[-1])),
x_axis
)
b_intestinihominis_best_fit = cbind(
proportional_sfs(b_intestinihominis_hmp_qp_syn[-1]),
proportional_sfs(b_intestinihominis_complete_two_epoch),
proportional_sfs(b_intestinihominis_hmp_qp_nonsyn[-1]),
proportional_sfs(b_intestinihominis_complete_gamma_dfe),
rep('B. intestinihominis', length(b_intestinihominis_hmp_qp_syn[-1])),
x_axis
)
e_eligens_best_fit = cbind(
proportional_sfs(e_eligens_hmp_qp_syn[-1]),
proportional_sfs(e_eligens_complete_two_epoch),
proportional_sfs(e_eligens_hmp_qp_nonsyn[-1]),
proportional_sfs(e_eligens_complete_gamma_dfe),
rep('E. eligens', length(e_eligens_hmp_qp_syn[-1])),
x_axis
)
e_rectale_best_fit = cbind(
proportional_sfs(e_rectale_hmp_qp_syn[-1]),
proportional_sfs(e_rectale_complete_two_epoch),
proportional_sfs(e_rectale_hmp_qp_nonsyn[-1]),
proportional_sfs(e_rectale_complete_gamma_dfe),
rep('E. rectale', length(e_rectale_hmp_qp_syn[-1])),
x_axis
)
f_prausnitzii_best_fit = cbind(
proportional_sfs(f_prausnitzii_hmp_qp_syn[-1]),
proportional_sfs(f_prausnitzii_complete_two_epoch),
proportional_sfs(f_prausnitzii_hmp_qp_nonsyn[-1]),
proportional_sfs(f_prausnitzii_complete_gamma_dfe),
rep('F. prausnitzii', length(f_prausnitzii_hmp_qp_syn[-1])),
x_axis
)
o_splanchnicus_best_fit = cbind(
proportional_sfs(o_splanchnicus_hmp_qp_syn[-1]),
proportional_sfs(o_splanchnicus_complete_two_epoch),
proportional_sfs(o_splanchnicus_hmp_qp_nonsyn[-1]),
proportional_sfs(o_splanchnicus_complete_gamma_dfe),
rep('O. splanchnicus', length(o_splanchnicus_hmp_qp_syn[-1])),
x_axis
)
oscillibacter_sp_best_fit = cbind(
proportional_sfs(oscillibacter_sp_hmp_qp_syn[-1]),
proportional_sfs(oscillibacter_sp_complete_two_epoch),
proportional_sfs(oscillibacter_sp_hmp_qp_nonsyn[-1]),
proportional_sfs(oscillibacter_sp_complete_gamma_dfe),
rep('Oscilibacter sp', length(oscillibacter_sp_hmp_qp_syn[-1])),
x_axis
)
p_distasonis_best_fit = cbind(
proportional_sfs(p_distasonis_hmp_qp_syn[-1]),
proportional_sfs(p_distasonis_complete_two_epoch),
proportional_sfs(p_distasonis_hmp_qp_nonsyn[-1]),
proportional_sfs(p_distasonis_complete_gamma_dfe),
rep('P. distasonis', length(p_distasonis_hmp_qp_syn[-1])),
x_axis
)
p_merdae_best_fit = cbind(
proportional_sfs(p_merdae_hmp_qp_syn[-1]),
proportional_sfs(p_merdae_complete_two_epoch),
proportional_sfs(p_merdae_hmp_qp_nonsyn[-1]),
proportional_sfs(p_merdae_complete_gamma_dfe),
rep('P. merdae', length(p_merdae_hmp_qp_syn[-1])),
x_axis
)
phascolarctobacterium_sp_best_fit = cbind(
proportional_sfs(phascolarctobacterium_sp_hmp_qp_syn[-1]),
proportional_sfs(phascolarctobacterium_sp_complete_two_epoch),
proportional_sfs(phascolarctobacterium_sp_hmp_qp_nonsyn[-1]),
proportional_sfs(phascolarctobacterium_sp_complete_gamma_dfe),
rep('Phascolarctobacterium sp', length(phascolarctobacterium_sp_hmp_qp_syn[-1])),
x_axis
)
p_copri_best_fit = cbind(
proportional_sfs(p_copri_hmp_qp_syn[-1]),
proportional_sfs(p_copri_complete_two_epoch),
proportional_sfs(p_copri_hmp_qp_nonsyn[-1]),
proportional_sfs(p_copri_complete_gamma_dfe),
rep('P. copri', length(p_copri_hmp_qp_syn[-1])),
x_axis
)
r_bicirculans_best_fit = cbind(
proportional_sfs(r_bicirculans_hmp_qp_syn[-1]),
proportional_sfs(r_bicirculans_complete_two_epoch),
proportional_sfs(r_bicirculans_hmp_qp_nonsyn[-1]),
proportional_sfs(r_bicirculans_complete_gamma_dfe),
rep('R. bicirculans', length(r_bicirculans_hmp_qp_syn[-1])),
x_axis
)
r_bromii_best_fit = cbind(
proportional_sfs(r_bromii_hmp_qp_syn[-1]),
proportional_sfs(r_bromii_complete_two_epoch),
proportional_sfs(r_bromii_hmp_qp_nonsyn[-1]),
proportional_sfs(r_bromii_complete_gamma_dfe),
rep('R. bromii', length(r_bromii_hmp_qp_syn[-1])),
x_axis
)
p1 = plot_best_fit_sfs(o_splanchnicus_best_fit) + ggtitle('Odoribacter splanchnicus')
p2 = plot_best_fit_sfs(e_eligens_best_fit) + ggtitle('Eubacterium eligens')
p3 = plot_best_fit_sfs(b_cellulosilyticus_best_fit) + ggtitle('Bacteroides cellulosilyticus')
p1 + p2 + p3 + plot_layout(ncol = 1)
p1_l = plot_likelihood_surface_contour('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/likelihood_surface.csv') + ggtitle('O. splanchnicus likelihood surface')
p2_l = plot_likelihood_surface_contour('../Analysis/Eubacterium_eligens_61678_downsampled_14/likelihood_surface.csv') + ggtitle('E. eligens likelihood surface')
p3_l = plot_likelihood_surface_contour('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/likelihood_surface.csv') + ggtitle('O. splanchnicus likelihood surface')
p1 + p1_l + p2 + p2_l + p3 + p3_l +  plot_layout(ncol=2)
# Phylogenetic Tree in APE
get_species_code_reference = function(code, reference) {
if (code %in% reference$species_id) {
return(reference[reference$species_id == code, ]$midas_number)
} else if(code %in% reference$midas_number) {
return(reference[reference$midas_number == code, ]$species_id)
}
}
# Read the input TSV file
input_table <- read.table("../Data/midas_tree/midas_db_v1.2/species_info.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
# Extract the midas_number from the species_id column
input_table$midas_number <- sub(".+_(\\d+)$", "\\1", input_table$species_id)
# Create a new data frame with species_id and midas_number columns
output_table <- data.frame(species_id = input_table$species_id, midas_number = input_table$midas_number)
# Save the output as a CSV file
write.csv(output_table, file = "../Data/midas_tree/midas_db_v1.2/species_code_reference.txt", row.names = FALSE)
# Print the output data frame
print(output_table)
# Load the ape package
# library(ape)
# Read the Newick file
input_tree <- read.tree("../Data/midas_tree/midas_db_v1.2/species_tree.newick")
# Specify the tip labels for the subtree you want to extract
species_subtree = c(
'Akkermansia_muciniphila_55290',
'Alistipes_finegoldii_56071',
'Alistipes_onderdonkii_55464',
'Alistipes_putredinis_61533',
'Alistipes_shahii_62199',
'Bacteroidales_bacterium_58650',
'Bacteroides_caccae_53434',
'Bacteroides_cellulosilyticus_58046',
'Bacteroides_fragilis_54507',
'Bacteroides_massiliensis_44749',
'Bacteroides_ovatus_58035',
'Bacteroides_stercoris_56735',
'Bacteroides_thetaiotaomicron_56941',
'Bacteroides_uniformis_57318',
'Bacteroides_vulgatus_57955',
'Bacteroides_xylanisolvens_57185',
'Barnesiella_intestinihominis_62208',
'Coprococcus_sp_62244',
'Dialister_invisus_61905',
'Eubacterium_eligens_61678',
'Eubacterium_rectale_56927',
'Faecalibacterium_prausnitzii_57453',
'Odoribacter_splanchnicus_62174',
'Oscillibacter_sp_60799',
'Parabacteroides_distasonis_56985',
'Parabacteroides_merdae_56972',
'Phascolarctobacterium_sp_59817',
'Prevotella_copri_61740',
'Ruminococcus_bicirculans_59300',
'Ruminococcus_bromii_62047'
)
midas_code_subtree = c()
for (species in species_subtree) {
midas_code_subtree = c(midas_code_subtree, get_species_code_reference(species, output_table))
}
print(midas_code_subtree)
subtree_tips = midas_code_subtree
# Extract the subtree
subtree <- keep.tip(input_tree, subtree_tips)
# Print the extracted subtree
print(subtree)
for (i in 1:length(subtree$tip.label)) {
print(subtree$tip.label[i])
new_tip = get_species_code_reference(subtree$tip.label[i], output_table)
# new_tip = str_sub(new_tip, 1, str_length(new_tip)-6)
subtree$tip.label[i] = new_tip
print(subtree$tip.label[i])
}
plot(subtree)
# Likelihood Surfaces
plot_likelihood_surface('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/likelihood_surface.csv') + ggtitle('A. muciniphila likelihood surface')
plot_likelihood_surface_contour('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/likelihood_surface.csv') + ggtitle('A. muciniphila likelihood surface')
plot_likelihood_surface_contour('../Analysis/Alistipes_finegoldii_56071_downsampled_14/likelihood_surface.csv') + ggtitle('A. finegoldii likelihood surface')
plot_likelihood_surface_contour('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/likelihood_surface.csv') + ggtitle('A. onderdonkii likelihood surface')
# plot_likelihood_surface('../Analysis/Alistipes_putredinis_61533_downsampled_14/likelihood_surface.csv') + ggtitle('A. muciniphila likelihood surface')
plot_likelihood_surface_contour('../Analysis/Alistipes_shahii_62199_downsampled_14/likelihood_surface.csv') + ggtitle('A. shahii likelihood surface')
plot_likelihood_surface_contour('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/likelihood_surface.csv') + ggtitle('B. bacterium likelihood surface')
# plot_likelihood_surface('../Analysis/Bacteroides_caccae_53434_downsampled_14/likelihood_surface.csv') + ggtitle('B. caccae likelihood surface')
plot_likelihood_surface('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/likelihood_surface.csv') + ggtitle('B. cellulosilyticus likelihood surface')
plot_likelihood_surface_contour('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/likelihood_surface.csv') + ggtitle('B. cellulosilyticus likelihood surface')
plot_likelihood_surface_contour('../Analysis/Bacteroides_fragilis_54507_downsampled_14/likelihood_surface.csv') + ggtitle('B. fragilis likelihood surface')
# plot_likelihood_surface('../Analysis/Bacteroides_massiliensis_44749_downsampled_14/likelihood_surface.csv') + ggtitle('A. muciniphila likelihood surface')
# plot_likelihood_surface('../Analysis/Bacteroides_ovatus_58035_downsampled_14/likelihood_surface.csv') + ggtitle('A. muciniphila likelihood surface')
plot_likelihood_surface_contour('../Analysis/Bacteroides_stercoris_56735_downsampled_14/likelihood_surface.csv') + ggtitle('B. stercoris likelihood surface')
plot_likelihood_surface_contour('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/likelihood_surface.csv') + ggtitle('B. thetaiotaomicron likelihood surface')
# plot_likelihood_surface('../Analysis/Bacteroides_uniformis_57318_downsampled_14/likelihood_surface.csv') + ggtitle('A. muciniphila likelihood surface')
plot_likelihood_surface_contour('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/likelihood_surface.csv') + ggtitle('B. vulgatus likelihood surface')
plot_likelihood_surface_contour('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/likelihood_surface.csv') + ggtitle('B. xylanisolvens likelihood surface')
plot_likelihood_surface_contour('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/likelihood_surface.csv') + ggtitle('B. intestinihominis likelihood surface')
# plot_likelihood_surface('../Analysis/Coprococcus_sp_62244_downsampled_14/likelihood_surface.csv') + ggtitle('A. muciniphila likelihood surface')
# plot_likelihood_surface('../Analysis/Dialister_invisus_61905_downsampled_14/likelihood_surface.csv') + ggtitle('A. muciniphila likelihood surface')
plot_likelihood_surface('../Analysis/Eubacterium_eligens_61678_downsampled_14/likelihood_surface.csv') + ggtitle('E. eligens likelihood surface')
plot_likelihood_surface_contour('../Analysis/Eubacterium_eligens_61678_downsampled_14/likelihood_surface.csv') + ggtitle('E. eligens likelihood surface')
plot_likelihood_surface_contour('../Analysis/Eubacterium_rectale_56927_downsampled_14/likelihood_surface.csv') + ggtitle('E. rectale likelihood surface')
plot_likelihood_surface_contour('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/likelihood_surface.csv') + ggtitle('F. prausnitzii likelihood surface')
plot_likelihood_surface('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/likelihood_surface.csv') + ggtitle('O. splanchnicus likelihood surface')
plot_likelihood_surface_contour('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/likelihood_surface.csv') + ggtitle('O. splanchnicus likelihood surface')
plot_likelihood_surface_contour('../Analysis/Oscillibacter_sp_60799_downsampled_14/likelihood_surface.csv') + ggtitle('Oscillibacter species likelihood surface')
plot_likelihood_surface_contour('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/likelihood_surface.csv') + ggtitle('P. distasonis likelihood surface')
plot_likelihood_surface_contour('../Analysis/Parabacteroides_merdae_56972_downsampled_14/likelihood_surface.csv') + ggtitle('P. merdae likelihood surface')
plot_likelihood_surface_contour('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/likelihood_surface.csv') + ggtitle('Phascolarctobacterium species likelihood surface')
plot_likelihood_surface_contour('../Analysis/Prevotella_copri_61740_downsampled_14/likelihood_surface.csv') + ggtitle('P. copri likelihood surface')
plot_likelihood_surface_contour('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/likelihood_surface.csv') + ggtitle('R. bicirculans likelihood surface')
plot_likelihood_surface_contour('../Analysis/Ruminococcus_bromii_62047_downsampled_14/likelihood_surface.csv') + ggtitle('R. bromii likelihood surface')
p1 = plot_best_fit_sfs(a_muciniphila_best_fit) + ggtitle('Akkermansia muciniphila')
p2 = plot_best_fit_sfs(a_finegoldii_best_fit) + ggtitle('Alistipes finegoldii')
p3 = plot_best_fit_sfs(a_onderdonkii_best_fit) + ggtitle('Alistipes onderdonkii')
# p4 = plot_best_fit_sfs(_best_fit)
p5 = plot_best_fit_sfs(a_shahii_best_fit) + ggtitle('Alistipes shahii')
p6 = plot_best_fit_sfs(b_bacterium_best_fit) + ggtitle('Bacteroidales bacterium')
# p7 = plot_best_fit_sfs(_best_fit)
p8 = plot_best_fit_sfs(b_cellulosilyticus_best_fit) + ggtitle('Bacteroides cellulosilyticus')
p9 = plot_best_fit_sfs(b_fragilis_best_fit) + ggtitle('Bacteroides fragilis')
# p10 = plot_best_fit_sfs(_best_fit)
# p11 = plot_best_fit_sfs(_best_fit)
p12 = plot_best_fit_sfs(b_stercoris_best_fit) + ggtitle('Bacteroides stercoris')
p13 = plot_best_fit_sfs(b_thetaiotaomicron_best_fit) + ggtitle('Bacteroides thetaiotaomicron')
# p14 = plot_best_fit_sfs(_best_fit)
p15 = plot_best_fit_sfs(b_vulgatus_best_fit) + ggtitle('Bacteroides vulgatus')
p16 = plot_best_fit_sfs(b_xylanisolvens_best_fit) + ggtitle('Bacteroides xylanisolvens')
p17 = plot_best_fit_sfs(b_intestinihominis_best_fit) + ggtitle('Barnesiella intestinihominis')
# p18 = plot_best_fit_sfs(_best_fit)
# p19 = plot_best_fit_sfs(_best_fit)
p20 = plot_best_fit_sfs(e_eligens_best_fit) + ggtitle('Eubacterium eligens')
p21 = plot_best_fit_sfs(e_rectale_best_fit) + ggtitle('Eubacterium rectale')
p22 = plot_best_fit_sfs(f_prausnitzii_best_fit) + ggtitle('Faecalibacterium prausnitzii')
p23 = plot_best_fit_sfs(o_splanchnicus_best_fit) + ggtitle('Odoribacter splanchnicus')
p24 = plot_best_fit_sfs(oscillibacter_sp_best_fit) + ggtitle('Oscillibacter species')
p25 = plot_best_fit_sfs(p_distasonis_best_fit) + ggtitle('Parabacteroides distasonis')
p26 = plot_best_fit_sfs(p_merdae_best_fit) + ggtitle('Parabacteroides merdae')
p27 = plot_best_fit_sfs(phascolarctobacterium_sp_best_fit) + ggtitle('Phascolarctobacterium species')
p28 = plot_best_fit_sfs(p_copri_best_fit) + ggtitle('Prevotella copri')
p29 = plot_best_fit_sfs(r_bicirculans_best_fit) + ggtitle('Ruminococcus bicirculans')
p30 = plot_best_fit_sfs(r_bromii_best_fit) + ggtitle('Ruminococcus bromii')
p1_l = plot_likelihood_surface_contour('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/likelihood_surface.csv')
p2_l = plot_likelihood_surface_contour('../Analysis/Alistipes_finegoldii_56071_downsampled_14/likelihood_surface.csv')
p3_l = plot_likelihood_surface_contour('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/likelihood_surface.csv')
# p4 = plot_likelihood_surface_contour('../Analysis/Alistipes_putredinis_61533_downsampled_14/likelihood_surface.csv')
p5_l = plot_likelihood_surface_contour('../Analysis/Alistipes_shahii_62199_downsampled_14/likelihood_surface.csv')
p6_l = plot_likelihood_surface_contour('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/likelihood_surface.csv')
# p7 = plot_likelihood_surface_contour('../Analysis/Bacteroides_caccae_53434_downsampled_14/likelihood_surface.csv')
p8_l = plot_likelihood_surface_contour('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/likelihood_surface.csv')
p9_l = plot_likelihood_surface_contour('../Analysis/Bacteroides_fragilis_54507_downsampled_14/likelihood_surface.csv')
# p10 = plot_likelihood_surface_contour('../Analysis/Bacteroides_massiliensis_44749_downsampled_14/likelihood_surface.csv')
# p11 = plot_likelihood_surface_contour('../Analysis/Bacteroides_ovatus_58035_downsampled_14/likelihood_surface.csv')
p12_l = plot_likelihood_surface_contour('../Analysis/Bacteroides_stercoris_56735_downsampled_14/likelihood_surface.csv')
p13_l = plot_likelihood_surface_contour('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/likelihood_surface.csv')
# p14 = plot_likelihood_surface_contour('../Analysis/Bacteroides_uniformis_57318_downsampled_14/likelihood_surface.csv')
p15_l = plot_likelihood_surface_contour('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/likelihood_surface.csv')
p16_l = plot_likelihood_surface_contour('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/likelihood_surface.csv')
p17_l = plot_likelihood_surface_contour('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/likelihood_surface.csv')
# p18 = plot_likelihood_surface_contour('../Analysis/Coprococcus_sp_62244_downsampled_14/likelihood_surface.csv')
# p19 = plot_likelihood_surface_contour('../Analysis/Dialister_invisus_61905_downsampled_14/likelihood_surface.csv')
p20_l = plot_likelihood_surface_contour('../Analysis/Eubacterium_eligens_61678_downsampled_14/likelihood_surface.csv')
p21_l = plot_likelihood_surface_contour('../Analysis/Eubacterium_rectale_56927_downsampled_14/likelihood_surface.csv')
p22_l = plot_likelihood_surface_contour('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/likelihood_surface.csv')
p23_l = plot_likelihood_surface_contour('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/likelihood_surface.csv')
p24_l = plot_likelihood_surface_contour('../Analysis/Oscillibacter_sp_60799_downsampled_14/likelihood_surface.csv')
p25_l = plot_likelihood_surface_contour('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/likelihood_surface.csv')
p26_l = plot_likelihood_surface_contour('../Analysis/Parabacteroides_merdae_56972_downsampled_14/likelihood_surface.csv')
p27_l = plot_likelihood_surface_contour('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/likelihood_surface.csv')
p28_l = plot_likelihood_surface_contour('../Analysis/Prevotella_copri_61740_downsampled_14/likelihood_surface.csv')
p29_l = plot_likelihood_surface_contour('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/likelihood_surface.csv')
p30_l = plot_likelihood_surface_contour('../Analysis/Ruminococcus_bromii_62047_downsampled_14/likelihood_surface.csv')
#phylogenetic_levels = c(
#  'Bacteroidales bacterium', p6
#  # 'Alistipes putredinis',
#  'Alistipes finegoldii', p2
#  'Alistipes onderdonkii', p3
#  'Alistipes shahii', p5
#  'Odoribacter splanchnicus',  p23
#  'Parabacteroides distasonis',  p25
#  'Parabacteroides merdae', p26
#  'Prevotella copri', p28
#  'Bacteroides fragilis',  p9
#  'Bacteroides cellulosilyticus', p8
#  'Bacteroides stercoris',  p12
#  # 'Bacteroides uniformis',
#  'Bacteroides thetaiotaomicron', p13
#  # 'Bacteroides ovatus',
#  'Bacteroides xylanisolvens', p16
#  # 'Bacteroides caccae',
#  # 'Bacteroides massiliensis',
#  'Bacteroides vulgatus', p15
#  'Barnesiella intestinihominis', p17
#  'Akkermansia muciniphila', p1
#  # 'Dialister invivus',
#  'Phascolarctobacterium species', p27
#  'Eubacterium eligens', p20
#  'Eubacterium rectale', p21
#  # 'Coprococcus species',
#  'Oscillibacter species', p24
#  'Ruminococcus bromii', p30
#  'Ruminococcus bicirculans',  p29
#  'Faecalibacterium prausnitzii' p22
#)
# 1600 x 16000
p6 + p6_l +
p2 + p2_l +
p3 + p3_l +
p5 + p5_l +
p23 + p23_l +
p25 + p25_l +
p26 + p26_l  +
p28 + p28_l +
p9 + p9_l +
p8 + p8_l +
p12 + p12_l +
p13 + p13_l +
p16 + p16_l +
p15 + p15_l +
p17 + p17_l +
p1 + p1_l +
p27 + p27_l +
p20 + p20_l +
p21 + p21_l +
p24 + p24_l +
p30 + p30_l +
p29 + p29_l +
p22 + p22_l +
plot_layout(ncol=2)
