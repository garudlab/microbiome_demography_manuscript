b_uniformis_weakly_deleterious,
b_thetaiotaomicron_weakly_deleterious,
b_xylanisolvens_weakly_deleterious,
b_caccae_weakly_deleterious,
b_vulgatus_weakly_deleterious)
mean(b_fragilis_moderately_deleterious,
b_cellulosilyticus_moderately_deleterious,
b_stercoris_moderately_deleterious,
b_uniformis_moderately_deleterious,
b_thetaiotaomicron_moderately_deleterious,
b_xylanisolvens_moderately_deleterious,
b_caccae_moderately_deleterious,
b_vulgatus_moderately_deleterious)
sum(b_fragilis_moderately_deleterious,
b_cellulosilyticus_moderately_deleterious,
b_stercoris_moderately_deleterious,
b_uniformis_moderately_deleterious,
b_thetaiotaomicron_moderately_deleterious,
b_xylanisolvens_moderately_deleterious,
b_caccae_moderately_deleterious,
b_vulgatus_moderately_deleterious)
sum(b_fragilis_moderately_deleterious,
b_cellulosilyticus_moderately_deleterious,
b_stercoris_moderately_deleterious,
b_uniformis_moderately_deleterious,
b_thetaiotaomicron_moderately_deleterious,
b_xylanisolvens_moderately_deleterious,
b_caccae_moderately_deleterious,
b_vulgatus_moderately_deleterious) / 8
# Bacteroides genus
sum(b_fragilis_weakly_deleterious,
b_cellulosilyticus_weakly_deleterious,
b_stercoris_weakly_deleterious,
b_uniformis_weakly_deleterious,
b_thetaiotaomicron_weakly_deleterious,
b_xylanisolvens_weakly_deleterious,
b_caccae_weakly_deleterious,
b_vulgatus_weakly_deleterious) / 8
sum(b_fragilis_moderately_deleterious,
b_cellulosilyticus_moderately_deleterious,
b_stercoris_moderately_deleterious,
b_uniformis_moderately_deleterious,
b_thetaiotaomicron_moderately_deleterious,
b_xylanisolvens_moderately_deleterious,
b_caccae_moderately_deleterious,
b_vulgatus_moderately_deleterious) / 8
# Bacteroides genus
sum(b_fragilis_weakly_deleterious,
b_cellulosilyticus_weakly_deleterious,
b_stercoris_weakly_deleterious,
b_uniformis_weakly_deleterious,
b_thetaiotaomicron_weakly_deleterious,
b_xylanisolvens_weakly_deleterious,
b_caccae_weakly_deleterious,
b_vulgatus_weakly_deleterious) / 8
sum(b_fragilis_moderately_deleterious,
b_cellulosilyticus_moderately_deleterious,
b_stercoris_moderately_deleterious,
b_uniformis_moderately_deleterious,
b_thetaiotaomicron_moderately_deleterious,
b_xylanisolvens_moderately_deleterious,
b_caccae_moderately_deleterious,
b_vulgatus_moderately_deleterious) / 8
sum(b_fragilis_highly_deleterious,
b_cellulosilyticus_highly_deleterious,
b_stercoris_highly_deleterious,
b_uniformis_highly_deleterious,
b_thetaiotaomicron_highly_deleterious,
b_xylanisolvens_highly_deleterious,
b_caccae_highly_deleterious,
b_vulgatus_highly_deleterious) / 8
sum(b_fragilis_lethal,
b_cellulosilyticus_lethal,
b_stercoris_lethal,
b_uniformis_lethal,
b_thetaiotaomicron_lethal,
b_xylanisolvens_lethal,
b_caccae_lethal,
b_vulgatus_lethal) / 8
print(c(b_fragilis_weakly_deleterious,
b_cellulosilyticus_weakly_deleterious,
b_stercoris_weakly_deleterious,
b_uniformis_weakly_deleterious,
b_thetaiotaomicron_weakly_deleterious,
b_xylanisolvens_weakly_deleterious,
b_caccae_weakly_deleterious,
b_vulgatus_weakly_deleterious))
print(c(b_fragilis_moderately_deleterious,
b_cellulosilyticus_moderately_deleterious,
b_stercoris_moderately_deleterious,
b_uniformis_moderately_deleterious,
b_thetaiotaomicron_moderately_deleterious,
b_xylanisolvens_moderately_deleterious,
b_caccae_moderately_deleterious,
b_vulgatus_moderately_deleterious))
print(c(b_fragilis_highly_deleterious,
b_cellulosilyticus_highly_deleterious,
b_stercoris_highly_deleterious,
b_uniformis_highly_deleterious,
b_thetaiotaomicron_highly_deleterious,
b_xylanisolvens_highly_deleterious,
b_caccae_highly_deleterious,
b_vulgatus_highly_deleterious))
print(c(b_fragilis_lethal,
b_cellulosilyticus_lethal,
b_stercoris_lethal,
b_uniformis_lethal,
b_thetaiotaomicron_lethal,
b_xylanisolvens_lethal,
b_caccae_lethal,
b_vulgatus_lethal))
sum(b_fragilis_highly_deleterious,
b_cellulosilyticus_highly_deleterious,
b_stercoris_highly_deleterious,
b_uniformis_highly_deleterious,
b_thetaiotaomicron_highly_deleterious,
b_xylanisolvens_highly_deleterious,
b_caccae_highly_deleterious,
b_vulgatus_highly_deleterious) / 8
sum(b_fragilis_lethal,
b_cellulosilyticus_lethal,
b_stercoris_lethal,
b_uniformis_lethal,
b_thetaiotaomicron_lethal,
b_xylanisolvens_lethal,
b_caccae_lethal,
b_vulgatus_lethal) / 8
# Bacteroides genus
sum(b_fragilis_weakly_deleterious,
b_cellulosilyticus_weakly_deleterious,
b_stercoris_weakly_deleterious,
b_uniformis_weakly_deleterious,
b_thetaiotaomicron_weakly_deleterious,
b_xylanisolvens_weakly_deleterious,
b_caccae_weakly_deleterious,
b_vulgatus_weakly_deleterious) / 8
sum(b_fragilis_moderately_deleterious,
b_cellulosilyticus_moderately_deleterious,
b_stercoris_moderately_deleterious,
b_uniformis_moderately_deleterious,
b_thetaiotaomicron_moderately_deleterious,
b_xylanisolvens_moderately_deleterious,
b_caccae_moderately_deleterious,
b_vulgatus_moderately_deleterious) / 8
0.34812  +  0.4736712
b_uniformis_lethal
b_thetaiotaomicron_lethal
acc_core_dfe_LRT_table
nu_tau_distribution
likelihood_surface_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_likelihood_surface.csv'
)
synonymous_sfs_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_empirical_syn_downsampled_sfs.txt'
)
nu_tau_distribution = data.frame(species=phylogenetic_levels,
nu_mle = numeric(27),
time_mle = numeric(27),
nu_low = numeric(27),
nu_high = numeric(27),
time_low = numeric(27),
time_high = numeric(27))
nu_tau_distribution
for (i in 1:length(likelihood_surface_file_list)) {
# nu_mle
nu_tau_distribution[i, 2] = return_nu_mle(likelihood_surface_file_list[i])
# nu_low
nu_tau_distribution[i, 4] = return_nu_low(likelihood_surface_file_list[i])
# nu_high
nu_tau_distribution[i, 5] =  return_nu_high(likelihood_surface_file_list[i])
# tau_mle
nu_tau_distribution[i, 3] = return_time_mle(likelihood_surface_file_list[i],
synonymous_sfs_file_list[i],
two_epoch_file_list[i])
# tau_low
nu_tau_distribution[i, 6] = return_time_low(likelihood_surface_file_list[i],
synonymous_sfs_file_list[i],
two_epoch_file_list[i])
# tau_high
nu_tau_distribution[i, 7] =  return_time_high(likelihood_surface_file_list[i],
synonymous_sfs_file_list[i],
two_epoch_file_list[i])
}
two_epoch_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_two_epoch_demography.txt'
)
one_epoch_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_one_epoch_demography.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_one_epoch_demography.txt'
)
two_epoch_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_two_epoch_demography.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_two_epoch_demography.txt'
)
accessory_two_epoch_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/accessory_two_epoch_demography.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/accessory_two_epoch_demography.txt'
)
three_epoch_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_three_epoch_demography.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_three_epoch_demography.txt'
)
species_list = c(
'Bacteroidales_bacterium_58650',
'Alistipes_putredinis_61533',
'Alistipes_finegoldii_56071',
'Alistipes_onderdonkii_55464',
'Alistipes_shahii_62199',
'Odoribacter_splanchnicus_62174',
'Parabacteroides_distasonis_56985',
'Parabacteroides_merdae_56972',
'Prevotella_copri_61740',
'Bacteroides_fragilis_54507',
'Bacteroides_cellulosilyticus_58046',
'Bacteroides_stercoris_56735',
'Bacteroides_uniformis_57318',
'Bacteroides_thetaiotaomicron_56941',
'Bacteroides_xylanisolvens_57185',
'Bacteroides_caccae_53434',
'Bacteroides_vulgatus_57955',
'Barnesiella_intestinihominis_62208',
'Akkermansia_muciniphila_55290',
'Dialister_invisus_61905',
'Phascolarctobacterium_sp_59817',
'Eubacterium_eligens_61678',
'Eubacterium_rectale_56927',
'Oscillibacter_sp_60799',
'Ruminococcus_bromii_62047',
'Ruminococcus_bicirculans_59300',
'Faecalibacterium_prausnitzii_57453'
)
AIC_matrix = data.frame(
one_epoch = numeric(27),
two_epoch = numeric(27),
three_epoch = numeric(27),
delta_AIC = numeric(27))
row.names(AIC_matrix) = species_list
for (i in 1:length(species_list)) {
AIC_matrix[i, 1] = AIC_from_demography(one_epoch_file_list[i])
AIC_matrix[i, 2] = AIC_from_demography(two_epoch_file_list[i])
AIC_matrix[i, 3] = AIC_from_demography(three_epoch_file_list[i])
AIC_matrix[i, 4] = abs(min(AIC_matrix[i, 1], AIC_matrix[i, 3]) - AIC_matrix[i, 2])
}
AIC_matrix
# write.csv(AIC_matrix,  file='../Summary/AIC_matrix.csv')
#  Distributions of Nu and Tau
likelihood_surface_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_likelihood_surface.csv',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_likelihood_surface.csv'
)
synonymous_sfs_file_list = c(
'../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Alistipes_putredinis_61533_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Alistipes_shahii_62199_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Prevotella_copri_61740_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_caccae_53434_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Dialister_invisus_61905_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Eubacterium_eligens_61678_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Eubacterium_rectale_56927_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Oscillibacter_sp_60799_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_empirical_syn_downsampled_sfs.txt',
'../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_empirical_syn_downsampled_sfs.txt'
)
nu_tau_distribution = data.frame(species=phylogenetic_levels,
nu_mle = numeric(27),
time_mle = numeric(27),
nu_low = numeric(27),
nu_high = numeric(27),
time_low = numeric(27),
time_high = numeric(27))
for (i in 1:length(likelihood_surface_file_list)) {
# nu_mle
nu_tau_distribution[i, 2] = return_nu_mle(likelihood_surface_file_list[i])
# nu_low
nu_tau_distribution[i, 4] = return_nu_low(likelihood_surface_file_list[i])
# nu_high
nu_tau_distribution[i, 5] =  return_nu_high(likelihood_surface_file_list[i])
# tau_mle
nu_tau_distribution[i, 3] = return_time_mle(likelihood_surface_file_list[i],
synonymous_sfs_file_list[i],
two_epoch_file_list[i])
# tau_low
nu_tau_distribution[i, 6] = return_time_low(likelihood_surface_file_list[i],
synonymous_sfs_file_list[i],
two_epoch_file_list[i])
# tau_high
nu_tau_distribution[i, 7] =  return_time_high(likelihood_surface_file_list[i],
synonymous_sfs_file_list[i],
two_epoch_file_list[i])
}
nu_tau_distribution
max(nu_tau_distribution$time_mle)
min(nu_tau_distribution$time_mle)
