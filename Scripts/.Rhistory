scale_x_log10(limits=c(1e-1, 1e1)) +
scale_y_log10(limits=c(1e1, 1e7)) +
theme(legend.title = element_text(size=30)) +
theme(legend.text = element_text(size=12)) +
guides(color = 'none') +
guides(shape = 'none')  +
geom_point(data=demography_df_highlight, color='red', shape=1, size=6) +
# geom_point(data=demography_df_highlight, aes(x=nu, y=time_low, color='red', shape=1, size=4))  +
ggtitle('Commensal Gut Microbiota have Varied Demographic Histories') +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=16,face="bold"))
# Full empirical SFS
plot_original_empirical_sfs(b_vulgatus_no_clade_control) + ggtitle('B. vulgatus full empirical SFS (unfolded with no Clade Control)') +
scale_x_continuous() +
guides(color = 'none', size = 'none', fill = 'none') +
ggtitle('Bacteroides vulgatus empirical Site-frequency Spectrum') +
xlab('Allele Frequency')
compare_hmp_sfs(b_cellulosilyticus_hmp_qp_syn, one_epoch_14, b_cellulsilyticus_complete_two_epoch, b_cellulosilyticus_complete_three_epoch, b_cellulosilyticus_hmp_qp_nonsyn, b_cellulosilyticus_complete_gamma_dfe, b_cellulosilyticus_complete_neugamma_dfe) + ggtitle('B. cellulosilyticus (Downsampled to 14)')
compare_hmp_sfs(e_eligens_hmp_qp_syn, one_epoch_14, e_eligens_complete_two_epoch, e_eligens_complete_three_epoch, e_eligens_hmp_qp_nonsyn, e_eligens_complete_gamma_dfe, e_eligens_complete_neugamma_dfe) + ggtitle('E. eligens (Downsampled to 14)')
compare_hmp_sfs(b_ovatus_hmp_qp_syn, one_epoch_14, b_ovatus_complete_two_epoch, b_ovatus_complete_three_epoch, b_ovatus_hmp_qp_nonsyn, b_ovatus_complete_gamma_dfe, b_ovatus_complete_neugamma_dfe) + ggtitle('B. ovatus (Downsampled to 14)')
p1 = ggplot(melt(o_splanchnicus_best_fit, id=c('Species', 'X.axis')), aes(x=X.axis, y=as.numeric(value), fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
xlab('Minor Allele Frequency') +
ylab('Proportion of Segregating Sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),                       panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
scale_fill_manual(values=c("blue4", "steelblue3", "goldenrod3", "goldenrod1")) +
ggtitle('Odoribacter splanchnicus')
p1
p2 = ggplot(melt(e_eligens_best_fit, id=c('Species', 'X.axis')), aes(x=X.axis, y=as.numeric(value), fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
xlab('Minor Allele Frequency') +
ylab('Proportion of Segregating Sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),                       panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
scale_fill_manual(values=c("blue4", "steelblue3", "goldenrod3", "goldenrod1")) +
ggtitle('Eubacterium eligens')
p2
p3 = ggplot(melt(b_cellulosilyticus_best_fit, id=c('Species', 'X.axis')), aes(x=X.axis, y=as.numeric(value), fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
xlab('Minor Allele Frequency') +
ylab('Proportion of Segregating Sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),                       panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
scale_fill_manual(values=c("blue4", "steelblue3", "goldenrod3", "goldenrod1")) +
ggtitle('Bacteroides cellulosilyticus')
p3
p1 + p2 + p3 + plot_layout(ncol = 1)
dfe_df$species = factor(dfe_df$species, levels=phylogenetic_levels)
# dfe_df$value = dfe_df$value * 2
dfe_df$value[dfe_df$value <= 1e-12] = 1e-12
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
dfe_dadi_df$value[dfe_dadi_df$value <= 1e-1] = 1e-1
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'neugamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by 2N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
phylogenetic_levels = c(
'Bacteroidales bacterium',
'Alistipes putredinis',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes shahii',
'Odoribacter splanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Bacteroides fragilis',
'Bacteroides cellulosilyticus',
'Bacteroides stercoris',
# 'Bacteroides uniformis',
'Bacteroides thetaiotaomicron',
# 'Bacteroides ovatus',
'Bacteroides xylanisolvens',
'Bacteroides caccae',
# 'Bacteroides massiliensis',
'Bacteroides vulgatus',
'Barnesiella intestinihominis',
'Akkermansia muciniphila',
# 'Dialister invivus',
'Phascolarctobacterium species',
'Eubacterium eligens',
'Eubacterium rectale',
# 'Coprococcus species',
'Oscillibacter species',
'Ruminococcus bromii',
'Ruminococcus bicirculans',
'Faecalibacterium prausnitzii'
)
phylogenetic_levels
dfe_df$species = factor(dfe_df$species, levels=phylogenetic_levels)
# dfe_df$value = dfe_df$value * 2
dfe_df$value[dfe_df$value <= 1e-12] = 1e-12
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
dfe_dadi_df$value[dfe_dadi_df$value <= 1e-1] = 1e-1
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
dfe_dadi_df$species = factor(dfe_dadi_df$species, levels=phylogenetic_levels)
# dfe_df$value = dfe_df$value * 2
dfe_df$value[dfe_df$value <= 1e-12] = 1e-12
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
dfe_dadi_df$value[dfe_dadi_df$value <= 1e-1] = 1e-1
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
dfe_dadi_df
p_sp_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_sp_dfe_dadi_params$species = 'Phascolarctobacterium species'
p_copri_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
p_copri_dfe_dadi_params$species = 'Prevotella copri'
r_bicirculans_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bicirculans_dfe_dadi_params$species = 'Ruminococcus bicirculans'
r_bromii_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Ruminococcus_bromii_62047_downsampled_14/inferred_DFE.txt')
r_bromii_dfe_dadi_params$species = 'Ruminococcus bromii'
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_onderdonkii_dfe_params),
melt(a_putredinis_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_caccae_dfe_params),
melt(b_cellulosilyticus_dfe_params),
melt(b_fragilis_dfe_params),
# melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
# melt(b_uniformis_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
# melt(d_invisus_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(o_sp_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params),
melt(r_bromii_dfe_params)
)
dfe_dadi_df = rbind(
melt(a_muciniphila_dfe_dadi_params),
melt(a_finegoldii_dfe_dadi_params),
melt(a_onderdonkii_dfe_dadi_params),
melt(a_putredinis_dfe_dadi_params),
melt(a_shahii_dfe_dadi_params),
melt(b_bacterium_dfe_dadi_params),
melt(b_caccae_dfe_dadi_params),
melt(b_cellulosilyticus_dfe_dadi_params),
melt(b_fragilis_dfe_dadi_params),
# melt(b_ovatus_dfe_dadi_params),
melt(b_stercoris_dfe_dadi_params),
melt(b_thetaiotaomicron_dfe_dadi_params),
# melt(b_uniformis_dfe_dadi_params),
melt(b_vulgatus_dfe_dadi_params),
melt(b_xylanisolvens_dfe_dadi_params),
melt(b_intestinihominis_dfe_dadi_params),
# melt(d_invisus_dfe_dadi_params),
melt(e_eligens_dfe_dadi_params),
melt(e_rectale_dfe_dadi_params),
melt(f_prausnitzii_dfe_dadi_params),
melt(o_splanchnicus_dfe_dadi_params),
melt(o_sp_dfe_dadi_params),
melt(p_distasonis_dfe_dadi_params),
melt(p_merdae_dfe_dadi_params),
melt(p_sp_dfe_dadi_params),
melt(p_copri_dfe_dadi_params),
melt(r_bicirculans_dfe_dadi_params),
melt(r_bromii_dfe_dadi_params)
)
phylogenetic_levels = c(
'Akkermansia muciniphila',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes putredinis',
'Alistipes shahii',
'Bacteroidales bacterium',
'Bacteroides caccae',
'Bacteroides cellulosilyticus',
'Bacteroides fragilis',
# 'Bacteroides ovatus',
'Bacteroides stercoris',
'Bacteroides thetaiotaomicron',
# 'Bacteroides uniformis',
'Bacteroides vulgatus',
'Bacteroides xylanisolvens',
'Barnesiella intestinihominis',
'Odoribacter splanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Eubacterium eligens',
'Eubacterium rectale',
'Faecalibacterium prausnitzii',
'Ruminococcus bicirculans',
'Ruminococcus bromii',
'Oscillibacter species',
# 'Dialister invisus',
'Phascolarctobacterium species')
phylogenetic_levels = c(
'Bacteroidales bacterium',
'Alistipes putredinis',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes shahii',
'Odoribacter splanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Bacteroides fragilis',
'Bacteroides cellulosilyticus',
'Bacteroides stercoris',
# 'Bacteroides uniformis',
'Bacteroides thetaiotaomicron',
# 'Bacteroides ovatus',
'Bacteroides xylanisolvens',
'Bacteroides caccae',
# 'Bacteroides massiliensis',
'Bacteroides vulgatus',
'Barnesiella intestinihominis',
'Akkermansia muciniphila',
# 'Dialister invivus',
'Phascolarctobacterium species',
'Eubacterium eligens',
'Eubacterium rectale',
# 'Coprococcus species',
'Oscillibacter species',
'Ruminococcus bromii',
'Ruminococcus bicirculans',
'Faecalibacterium prausnitzii'
)
dfe_df$species = factor(dfe_df$species, levels=phylogenetic_levels)
dfe_dadi_df$species = factor(dfe_dadi_df$species, levels=phylogenetic_levels)
# dfe_df$value = dfe_df$value * 2
dfe_df$value[dfe_df$value <= 1e-12] = 1e-12
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
dfe_dadi_df$value[dfe_dadi_df$value <= 1e-1] = 1e-1
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'neugamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by 2N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
p1 = ggplot(melt(o_splanchnicus_best_fit, id=c('Species', 'X.axis')), aes(x=X.axis, y=as.numeric(value), fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
xlab('Minor Allele Frequency') +
ylab('Proportion of Segregating Sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),                       panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
scale_fill_manual(values=c("blue4", "steelblue3", "goldenrod3", "goldenrod1")) +
ggtitle('Odoribacter splanchnicus')
p1
p2 = ggplot(melt(e_eligens_best_fit, id=c('Species', 'X.axis')), aes(x=X.axis, y=as.numeric(value), fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
xlab('Minor Allele Frequency') +
ylab('Proportion of Segregating Sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),                       panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
scale_fill_manual(values=c("blue4", "steelblue3", "goldenrod3", "goldenrod1")) +
ggtitle('Eubacterium eligens')
p2
p3 = ggplot(melt(b_cellulosilyticus_best_fit, id=c('Species', 'X.axis')), aes(x=X.axis, y=as.numeric(value), fill=variable)) +
geom_bar(position='dodge2', stat='identity') +
labs(x = "", fill = "") +
xlab('Minor Allele Frequency') +
ylab('Proportion of Segregating Sites') +
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),                       panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) +
scale_fill_manual(values=c("blue4", "steelblue3", "goldenrod3", "goldenrod1")) +
ggtitle('Bacteroides cellulosilyticus')
p3
