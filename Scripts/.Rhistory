# compare_isolate_hmp_sfs(p_copri_orig[-1], p_copri_14_two_epoch,
#                         p_copri_hmp_qp_syn[-1], p_copri_complete_two_epoch,
#                         p_copri_14_isolate[-1], p_copri_isolate_two_epoch,
#                         one_epoch_14) + ggtitle('P. copri SFS comparison')
#
#
# compare_isolate_hmp_sfs(r_bromii_orig[-1], r_bromii_14_two_epoch,
#                         r_bromii_hmp_qp_syn[-1], r_bromii_complete_two_epoch,
#                         r_bromii_14_isolate[-1], r_bromii_isolate_two_epoch,
#                         one_epoch_14) + ggtitle('R. bromii SFS comparison')
# DFE Comparison
a_muciniphila_dfe_params = read_dfe_params('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_muciniphila_dfe_params$species = 'A. muciniphila'
a_finegoldii_dfe_params = read_dfe_params('../Analysis/Alistipes_finegoldii_56071_downsampled_14/inferred_DFE.txt')
a_finegoldii_dfe_params$species = 'A. finegoldii'
a_onderdonkii_dfe_params = read_dfe_params('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/inferred_DFE.txt')
a_onderdonkii_dfe_params$species = 'A. onderdonkii (bad fit)'
a_putredinis_dfe_params = read_dfe_params('../Analysis/Alistipes_putredinis_61533_downsampled_14/inferred_DFE.txt')
a_putredinis_dfe_params$species = 'A. putredinis'
a_shahii_dfe_params = read_dfe_params('../Analysis/Alistipes_shahii_62199_downsampled_14/inferred_DFE.txt')
a_shahii_dfe_params$species = 'A. shahii'
b_bacterium_dfe_params = read_dfe_params('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/inferred_DFE.txt')
b_bacterium_dfe_params$species = 'B. bacterium'
b_caccae_dfe_params = read_dfe_params('../Analysis/Bacteroides_caccae_53434_downsampled_14/inferred_DFE.txt')
b_caccae_dfe_params$species = 'B. caccae (bad fit)'
b_cellulosilyticus_dfe_params = read_dfe_params('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/inferred_DFE.txt')
b_cellulosilyticus_dfe_params$species = 'B. cellulosilyticus'
b_fragilis_dfe_params = read_dfe_params('../Analysis/Bacteroides_fragilis_54507_downsampled_14/inferred_DFE.txt')
b_fragilis_dfe_params$species = 'B. fragilis'
b_ovatus_dfe_params = read_dfe_params('../Analysis/Bacteroides_ovatus_58035_downsampled_14/inferred_DFE.txt')
b_ovatus_dfe_params$species = 'B. ovatus'
b_stercoris_dfe_params = read_dfe_params('../Analysis/Bacteroides_stercoris_56735_downsampled_14/inferred_DFE.txt')
b_stercoris_dfe_params$species = 'B. stercoris'
b_thetaiotaomicron_dfe_params = read_dfe_params('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/inferred_DFE.txt')
b_thetaiotaomicron_dfe_params$species = 'B. thetaiotaomicron'
b_uniformis_dfe_params = read_dfe_params('../Analysis/Bacteroides_uniformis_57318_downsampled_14/inferred_DFE.txt')
b_uniformis_dfe_params$species = 'B. uniformis'
b_vulgatus_dfe_params = read_dfe_params('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/inferred_DFE.txt')
b_vulgatus_dfe_params$species = 'B. vulgatus'
b_xylanisolvens_dfe_params = read_dfe_params('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/inferred_DFE.txt')
b_xylanisolvens_dfe_params$species = 'B. xylanisolvens'
b_intestinihominis_dfe_params = read_dfe_params('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/inferred_DFE.txt')
b_intestinihominis_dfe_params$species = 'B. intestinihominis'
d_invisus_dfe_params = read_dfe_params('../Analysis/Dialister_invisus_61905_downsampled_14/inferred_DFE.txt')
d_invisus_dfe_params$species = 'D. invisus (bad fit)'
e_eligens_dfe_params = read_dfe_params('../Analysis/Eubacterium_eligens_61678_downsampled_14/inferred_DFE.txt')
e_eligens_dfe_params$species = 'E. eligens'
e_rectale_dfe_params = read_dfe_params('../Analysis/Eubacterium_rectale_56927_downsampled_14/inferred_DFE.txt')
e_rectale_dfe_params$species = 'E. rectale'
f_prausnitzii_dfe_params = read_dfe_params('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/inferred_DFE.txt')
f_prausnitzii_dfe_params$species = 'F. prausnitzii'
o_splanchnicus_dfe_params = read_dfe_params('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/inferred_DFE.txt')
o_splanchnicus_dfe_params$species = 'O. splanchnicus'
o_sp_dfe_params = read_dfe_params('../Analysis/Oscillibacter_sp_60799_downsampled_14/inferred_DFE.txt')
o_sp_dfe_params$species = 'Oscillibacter sp. (bad fit)'
p_distasonis_dfe_params = read_dfe_params('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/inferred_DFE.txt')
p_distasonis_dfe_params$species = 'P. distasonis'
p_merdae_dfe_params = read_dfe_params('../Analysis/Parabacteroides_merdae_56972_downsampled_14/inferred_DFE.txt')
p_merdae_dfe_params$species = 'P. merdae'
p_sp_dfe_params = read_dfe_params('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_sp_dfe_params$species = 'Phascolarcobacterium species'
p_copri_dfe_params = read_dfe_params('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
p_copri_dfe_params$species = 'P. copri'
r_bicirculans_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bicirculans_dfe_params$species = 'R. bicirculans'
r_bromii_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bromii_62047_downsampled_14/inferred_DFE.txt')
r_bromii_dfe_params$species = 'R. bromii (bad fit)'
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_onderdonkii_dfe_params),
melt(a_putredinis_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_caccae_dfe_params),
melt(b_cellulosilyticus_dfe_params),
melt(b_fragilis_dfe_params),
melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
melt(b_uniformis_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
melt(d_invisus_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(o_sp_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params),
melt(r_bromii_dfe_params)
)
# Temp exclusion
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_cellulosilyticus_dfe_params),
melt(b_fragilis_dfe_params),
melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params)
)
# dfe_df
# dfe_df$value[dfe_df$value <= 1e-16]$value = 1e-16
dfe_df$value[dfe_df$value <= 1e-14] = 1e-14
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
compare_hmp_sfs(a_shahii_hmp_qp_syn, one_epoch_14, a_shahii_complete_two_epoch, a_shahii_complete_three_epoch, a_shahii_hmp_qp_nonsyn, a_shahii_complete_gamma_dfe, a_shahii_complete_neugamma_dfe) + ggtitle('Alistipes shahii (Downsampled to 14)')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
# DFE Comparison
a_muciniphila_dfe_params = read_dfe_params('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_muciniphila_dfe_params$species = 'A. muciniphila'
a_finegoldii_dfe_params = read_dfe_params('../Analysis/Alistipes_finegoldii_56071_downsampled_14/inferred_DFE.txt')
a_finegoldii_dfe_params$species = 'A. finegoldii'
a_onderdonkii_dfe_params = read_dfe_params('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/inferred_DFE.txt')
a_onderdonkii_dfe_params$species = 'A. onderdonkii (bad fit)'
a_putredinis_dfe_params = read_dfe_params('../Analysis/Alistipes_putredinis_61533_downsampled_14/inferred_DFE.txt')
a_putredinis_dfe_params$species = 'A. putredinis'
a_shahii_dfe_params = read_dfe_params('../Analysis/Alistipes_shahii_62199_downsampled_14/inferred_DFE.txt')
a_shahii_dfe_params$species = 'A. shahii'
b_bacterium_dfe_params = read_dfe_params('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/inferred_DFE.txt')
b_bacterium_dfe_params$species = 'B. bacterium'
b_caccae_dfe_params = read_dfe_params('../Analysis/Bacteroides_caccae_53434_downsampled_14/inferred_DFE.txt')
b_caccae_dfe_params$species = 'B. caccae (bad fit)'
b_cellulosilyticus_dfe_params = read_dfe_params('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/inferred_DFE.txt')
b_cellulosilyticus_dfe_params$species = 'B. cellulosilyticus'
b_fragilis_dfe_params = read_dfe_params('../Analysis/Bacteroides_fragilis_54507_downsampled_14/inferred_DFE.txt')
b_fragilis_dfe_params$species = 'B. fragilis'
b_ovatus_dfe_params = read_dfe_params('../Analysis/Bacteroides_ovatus_58035_downsampled_14/inferred_DFE.txt')
b_ovatus_dfe_params$species = 'B. ovatus'
b_stercoris_dfe_params = read_dfe_params('../Analysis/Bacteroides_stercoris_56735_downsampled_14/inferred_DFE.txt')
b_stercoris_dfe_params$species = 'B. stercoris'
b_thetaiotaomicron_dfe_params = read_dfe_params('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/inferred_DFE.txt')
b_thetaiotaomicron_dfe_params$species = 'B. thetaiotaomicron'
b_uniformis_dfe_params = read_dfe_params('../Analysis/Bacteroides_uniformis_57318_downsampled_14/inferred_DFE.txt')
b_uniformis_dfe_params$species = 'B. uniformis'
b_vulgatus_dfe_params = read_dfe_params('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/inferred_DFE.txt')
b_vulgatus_dfe_params$species = 'B. vulgatus'
b_xylanisolvens_dfe_params = read_dfe_params('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/inferred_DFE.txt')
b_xylanisolvens_dfe_params$species = 'B. xylanisolvens'
b_intestinihominis_dfe_params = read_dfe_params('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/inferred_DFE.txt')
b_intestinihominis_dfe_params$species = 'B. intestinihominis'
d_invisus_dfe_params = read_dfe_params('../Analysis/Dialister_invisus_61905_downsampled_14/inferred_DFE.txt')
d_invisus_dfe_params$species = 'D. invisus (bad fit)'
e_eligens_dfe_params = read_dfe_params('../Analysis/Eubacterium_eligens_61678_downsampled_14/inferred_DFE.txt')
e_eligens_dfe_params$species = 'E. eligens'
e_rectale_dfe_params = read_dfe_params('../Analysis/Eubacterium_rectale_56927_downsampled_14/inferred_DFE.txt')
e_rectale_dfe_params$species = 'E. rectale'
f_prausnitzii_dfe_params = read_dfe_params('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/inferred_DFE.txt')
f_prausnitzii_dfe_params$species = 'F. prausnitzii'
o_splanchnicus_dfe_params = read_dfe_params('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/inferred_DFE.txt')
o_splanchnicus_dfe_params$species = 'O. splanchnicus'
o_sp_dfe_params = read_dfe_params('../Analysis/Oscillibacter_sp_60799_downsampled_14/inferred_DFE.txt')
o_sp_dfe_params$species = 'Oscillibacter sp. (bad fit)'
p_distasonis_dfe_params = read_dfe_params('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/inferred_DFE.txt')
p_distasonis_dfe_params$species = 'P. distasonis'
p_merdae_dfe_params = read_dfe_params('../Analysis/Parabacteroides_merdae_56972_downsampled_14/inferred_DFE.txt')
p_merdae_dfe_params$species = 'P. merdae'
p_sp_dfe_params = read_dfe_params('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_sp_dfe_params$species = 'Phascolarcobacterium species'
p_copri_dfe_params = read_dfe_params('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
p_copri_dfe_params$species = 'P. copri'
r_bicirculans_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bicirculans_dfe_params$species = 'R. bicirculans'
r_bromii_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bromii_62047_downsampled_14/inferred_DFE.txt')
r_bromii_dfe_params$species = 'R. bromii (bad fit)'
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_onderdonkii_dfe_params),
melt(a_putredinis_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_caccae_dfe_params),
melt(b_cellulosilyticus_dfe_params),
melt(b_fragilis_dfe_params),
melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
melt(b_uniformis_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
melt(d_invisus_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(o_sp_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params),
melt(r_bromii_dfe_params)
)
# dfe_df$value[dfe_df$value <= 1e-16]$value = 1e-16
dfe_df$value[dfe_df$value <= 1e-14] = 1e-14
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
a_muciniphila_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_finegoldii_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Alistipes_finegoldii_56071_downsampled_14/inferred_DFE.txt')
a_onderdonkii_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/inferred_DFE.txt')
a_putredinis_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Alistipes_putredinis_61533_downsampled_14/inferred_DFE.txt')
a_shahii_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Alistipes_shahii_62199_downsampled_14/inferred_DFE.txt')
b_bacterium_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/inferred_DFE.txt')
b_caccae_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_caccae_53434_downsampled_14/inferred_DFE.txt')
b_cellulosilyticus_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/inferred_DFE.txt')
b_fragilis_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_fragilis_54507_downsampled_14/inferred_DFE.txt')
b_ovatus_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_ovatus_58035_downsampled_14/inferred_DFE.txt')
b_stercoris_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_stercoris_56735_downsampled_14/inferred_DFE.txt')
b_thetaiotaomicron_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/inferred_DFE.txt')
b_uniformis_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_uniformis_57318_downsampled_14/inferred_DFE.txt')
b_vulgatus_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/inferred_DFE.txt')
b_xylanisolvens_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/inferred_DFE.txt')
b_intestinihominis_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/inferred_DFE.txt')
d_invisus_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Dialister_invisus_61905_downsampled_14/inferred_DFE.txt')
e_eligens_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Eubacterium_eligens_61678_downsampled_14/inferred_DFE.txt')
e_rectale_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Eubacterium_rectale_56927_downsampled_14/inferred_DFE.txt')
f_prausnitzii_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/inferred_DFE.txt')
o_splanchnicus_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/inferred_DFE.txt')
o_sp_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Oscillibacter_sp_60799_downsampled_14/inferred_DFE.txt')
p_distasonis_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/inferred_DFE.txt')
p_merdae_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Parabacteroides_merdae_56972_downsampled_14/inferred_DFE.txt')
p_sp_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_copri_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
r_bicirculans_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bromii_complete_gamma_dfe = gamma_sfs_from_dfe('../Analysis/Ruminococcus_bromii_62047_downsampled_14/inferred_DFE.txt')
a_muciniphila_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_finegoldii_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Alistipes_finegoldii_56071_downsampled_14/inferred_DFE.txt')
a_onderdonkii_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/inferred_DFE.txt')
a_putredinis_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Alistipes_putredinis_61533_downsampled_14/inferred_DFE.txt')
a_shahii_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Alistipes_shahii_62199_downsampled_14/inferred_DFE.txt')
b_bacterium_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/inferred_DFE.txt')
b_caccae_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_caccae_53434_downsampled_14/inferred_DFE.txt')
b_cellulosilyticus_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/inferred_DFE.txt')
b_fragilis_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_fragilis_54507_downsampled_14/inferred_DFE.txt')
b_ovatus_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_ovatus_58035_downsampled_14/inferred_DFE.txt')
b_stercoris_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_stercoris_56735_downsampled_14/inferred_DFE.txt')
b_thetaiotaomicron_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/inferred_DFE.txt')
b_uniformis_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_uniformis_57318_downsampled_14/inferred_DFE.txt')
b_vulgatus_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/inferred_DFE.txt')
b_xylanisolvens_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/inferred_DFE.txt')
b_intestinihominis_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/inferred_DFE.txt')
d_invisus_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Dialister_invisus_61905_downsampled_14/inferred_DFE.txt')
e_eligens_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Eubacterium_eligens_61678_downsampled_14/inferred_DFE.txt')
e_rectale_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Eubacterium_rectale_56927_downsampled_14/inferred_DFE.txt')
f_prausnitzii_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/inferred_DFE.txt')
o_splanchnicus_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/inferred_DFE.txt')
o_sp_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Oscillibacter_sp_60799_downsampled_14/inferred_DFE.txt')
p_distasonis_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/inferred_DFE.txt')
p_merdae_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Parabacteroides_merdae_56972_downsampled_14/inferred_DFE.txt')
p_sp_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_copri_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
r_bicirculans_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bromii_complete_neugamma_dfe = neugamma_sfs_from_dfe('../Analysis/Ruminococcus_bromii_62047_downsampled_14/inferred_DFE.txt')
compare_hmp_sfs(a_muciniphila_hmp_qp_syn, one_epoch_14, a_muciniphila_complete_two_epoch, a_muciniphila_complete_three_epoch, a_muciniphila_hmp_qp_nonsyn, a_muciniphila_complete_gamma_dfe, a_muciniphila_complete_neugamma_dfe) + ggtitle('A. muciniphila (Downsampled to 14)')
compare_hmp_sfs(a_finegoldii_hmp_qp_syn, one_epoch_14, a_finegoldii_complete_two_epoch, a_finegoldii_complete_three_epoch, a_finegoldii_hmp_qp_nonsyn, a_finegoldii_complete_gamma_dfe, a_finegoldii_complete_neugamma_dfe) + ggtitle('A. finegoldii (Downsampled to 14)')
compare_hmp_sfs(a_onderdonkii_hmp_qp_syn, one_epoch_14, a_onderdonkii_complete_two_epoch, a_onderdonkii_complete_three_epoch, a_onderdonkii_hmp_qp_nonsyn, a_onderdonkii_complete_gamma_dfe, a_onderdonkii_complete_neugamma_dfe) + ggtitle('A. onderdonkii (Downsampled to 14)')
compare_hmp_sfs(a_putredinis_hmp_qp_syn, one_epoch_14, a_putredinis_complete_two_epoch, a_putredinis_complete_three_epoch, a_putredinis_hmp_qp_nonsyn, a_putredinis_complete_gamma_dfe, a_putredinis_complete_neugamma_dfe) + ggtitle('A. putredinis (Downsampled to 14)')
compare_hmp_sfs(a_shahii_hmp_qp_syn, one_epoch_14, a_shahii_complete_two_epoch, a_shahii_complete_three_epoch, a_shahii_hmp_qp_nonsyn, a_shahii_complete_gamma_dfe, a_shahii_complete_neugamma_dfe) + ggtitle('Alistipes shahii (Downsampled to 14)')
compare_hmp_sfs(b_bacterium_hmp_qp_syn, one_epoch_14, b_bacterium_complete_two_epoch, b_bacterium_complete_three_epoch, b_bacterium_hmp_qp_nonsyn, b_bacterium_complete_gamma_dfe, b_bacterium_complete_neugamma_dfe) + ggtitle('B. bacterium (Downsampled to 14)')
compare_hmp_sfs(b_caccae_hmp_qp_syn, one_epoch_14, b_caccae_complete_two_epoch, b_caccae_complete_three_epoch, b_caccae_hmp_qp_nonsyn, b_caccae_complete_gamma_dfe, b_caccae_complete_neugamma_dfe) + ggtitle('B. caccae (Downsampled to 14)')
compare_hmp_sfs(b_cellulosilyticus_hmp_qp_syn, one_epoch_14, b_cellulsilyticus_complete_two_epoch, b_cellulosilyticus_complete_three_epoch, b_cellulosilyticus_hmp_qp_nonsyn, b_cellulosilyticus_complete_gamma_dfe, b_cellulosilyticus_complete_neugamma_dfe) + ggtitle('B. cellulosilyticus (Downsampled to 14)')
compare_hmp_sfs(b_fragilis_hmp_qp_syn, one_epoch_14, b_fragilis_complete_two_epoch, b_fragilis_complete_three_epoch, b_fragilis_hmp_qp_nonsyn, b_fragilis_complete_gamma_dfe, b_fragilis_complete_neugamma_dfe) + ggtitle('B. fragilis (Downsampled to 14)')
compare_hmp_sfs(b_ovatus_hmp_qp_syn, one_epoch_14, b_ovatus_complete_two_epoch, b_ovatus_complete_three_epoch, b_ovatus_hmp_qp_nonsyn, b_ovatus_complete_gamma_dfe, b_ovatus_complete_neugamma_dfe) + ggtitle('B. ovatus (Downsampled to 14)')
compare_hmp_sfs(b_stercoris_hmp_qp_syn, one_epoch_14, b_stercoris_complete_two_epoch, b_stercoris_complete_three_epoch, b_stercoris_hmp_qp_nonsyn, b_stercoris_complete_gamma_dfe, b_stercoris_complete_neugamma_dfe) + ggtitle('B. stercoris (Downsampled to 14)')
compare_hmp_sfs(b_uniformis_hmp_qp_syn, one_epoch_14, b_uniformis_complete_two_epoch, b_uniformis_complete_three_epoch, b_uniformis_hmp_qp_nonsyn, b_uniformis_complete_gamma_dfe, b_uniformis_complete_neugamma_dfe) + ggtitle('B. uniformis (Downsampled, to 14)')
compare_hmp_sfs(b_vulgatus_hmp_qp_syn, one_epoch_14, b_vulgatus_complete_two_epoch, b_vulgatus_complete_three_epoch, b_vulgatus_hmp_qp_nonsyn, b_vulgatus_complete_gamma_dfe, b_vulgatus_complete_neugamma_dfe) + ggtitle('B. vulgatus (Downsampled to 14)')
compare_hmp_sfs(b_xylanisolvens_hmp_qp_syn, one_epoch_14, b_xylanisolvens_complete_two_epoch, b_xylanisolvens_complete_three_epoch, b_xylanisolvens_hmp_qp_nonsyn, b_xylanisolvens_complete_gamma_dfe, b_xylanisolvens_complete_neugamma_dfe) + ggtitle('B. xylanisolvens (Downsampled to 14)')
compare_hmp_sfs(b_intestinihominis_hmp_qp_syn, one_epoch_14, b_intestinihominis_complete_two_epoch, b_intestinihominis_complete_three_epoch, b_intestinihominis_hmp_qp_nonsyn, b_intestinihominis_complete_gamma_dfe, b_intestinihominis_complete_neugamma_dfe) + ggtitle('B. intestinihominis (Downsampled to 14)')
compare_hmp_sfs(d_invisus_hmp_qp_syn, one_epoch_14, d_invisus_complete_two_epoch, d_invisus_complete_three_epoch, d_invisus_hmp_qp_nonsyn, d_invisus_complete_gamma_dfe, d_invisus_complete_neugamma_dfe) + ggtitle('D. invisus (Downsampled to 14)')
compare_hmp_sfs(e_eligens_hmp_qp_syn, one_epoch_14, e_eligens_complete_two_epoch, e_eligens_complete_three_epoch, e_eligens_hmp_qp_nonsyn, e_eligens_complete_gamma_dfe, e_eligens_complete_neugamma_dfe) + ggtitle('E. eligens (Downsampled to 14)')
compare_hmp_sfs(e_rectale_hmp_qp_syn, one_epoch_14, e_rectale_complete_two_epoch, e_rectale_complete_three_epoch, e_rectale_hmp_qp_nonsyn, e_rectale_complete_gamma_dfe, e_rectale_complete_neugamma_dfe) + ggtitle('E. rectale (Downsampled to 14)')
compare_hmp_sfs(f_prausnitzii_hmp_qp_syn, one_epoch_14, f_prausnitzii_complete_two_epoch, f_prausnitzii_complete_three_epoch, f_prausnitzii_hmp_qp_nonsyn, f_prausnitzii_complete_gamma_dfe, f_prausnitzii_complete_neugamma_dfe) + ggtitle('F. prausnitzii (Downsampled to 14)')
compare_hmp_sfs(o_splanchnicus_hmp_qp_syn, one_epoch_14, o_splanchnicus_complete_two_epoch, o_splanchnicus_complete_three_epoch,  o_splanchnicus_hmp_qp_nonsyn, o_splanchnicus_complete_gamma_dfe, o_splanchnicus_complete_neugamma_dfe) + ggtitle('O. splanchnicus (Downsampled to 14)')
compare_hmp_sfs(o_sp_hmp_qp_syn, one_epoch_14, o_sp_complete_two_epoch, o_sp_complete_three_epoch, o_sp_hmp_qp_nonsyn, o_sp_complete_gamma_dfe, o_sp_complete_neugamma_dfe) + ggtitle('Oscillibacter sp. (Downsampled to 14)')
compare_hmp_sfs(p_distasonis_hmp_qp_syn, one_epoch_14, p_distasonis_complete_two_epoch, p_distasonis_complete_three_epoch, p_distasonis_hmp_qp_nonsyn, p_distasonis_complete_gamma_dfe, p_distasonis_complete_neugamma_dfe) + ggtitle('P. distasonis (Downsampled to 14)')
compare_hmp_sfs(p_merdae_hmp_qp_syn, one_epoch_14, p_merdae_complete_two_epoch, p_merdae_complete_three_epoch, p_merdae_hmp_qp_nonsyn, p_merdae_complete_gamma_dfe, p_merdae_complete_neugamma_dfe) + ggtitle('P. merdae (Downsampled to 14)')
compare_hmp_sfs(p_sp_hmp_qp_syn, one_epoch_14, p_sp_complete_two_epoch, p_sp_complete_three_epoch, p_sp_hmp_qp_nonsyn, p_sp_complete_gamma_dfe, p_sp_complete_neugamma_dfe) + ggtitle('Phascolarctobacterium sp. (Downsampled to 14)')
compare_hmp_sfs(p_copri_hmp_qp_syn, one_epoch_14, p_copri_complete_two_epoch, p_copri_complete_three_epoch, p_copri_hmp_qp_nonsyn, p_copri_complete_gamma_dfe, p_copri_complete_neugamma_dfe) + ggtitle('P. copri (Downsampled to 14)')
compare_hmp_sfs(r_bicirculans_hmp_qp_syn, one_epoch_14, r_bicirculans_complete_two_epoch, r_bicirculans_complete_three_epoch, r_bicirculans_hmp_qp_nonsyn, r_bicirculans_complete_gamma_dfe, r_bicirculans_complete_neugamma_dfe) + ggtitle('R. bicirculans (Downsampled to 14)')
compare_hmp_sfs(r_bromii_hmp_qp_syn, one_epoch_14, r_bromii_complete_two_epoch, r_bromii_complete_three_epoch, r_bromii_hmp_qp_nonsyn, r_bromii_complete_gamma_dfe, r_bromii_complete_neugamma_dfe) + ggtitle('R. bromii (Downsampled to 14)')
two_epoch_nu_tau = read.csv('../Summary/two_epoch_demography_interpretation.csv')
two_epoch_nu_tau
three_epoch_nu_tau= read.csv('../Summary/three_epoch_demography_interpretation.csv')
ggscatter(two_epoch_nu_tau)
ggscatter(two_epoch_nu_tau, x=nu, y=time_low)
ggscatter(two_epoch_nu_tau, x="nu", y="time_low")
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species")
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species")
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + vline(yintercept=1)
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + hline(yintercept=1)
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + abline(v=1)
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + abline(v=1)
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species")
abline(v=1)
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + geom_vline(xintercept=1)
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + geom_vline(xintercept=1)
ggscatter(three_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + geom_vline(xintercept=1)
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + geom_vline(xintercept=1) +
ylab('Time in Years')
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + geom_vline(xintercept=1) +
ylab('Time in Years') +
xlab('Ratio of current to ancestral population size')
three_epoch_nu_tau
compare_hmp_sfs(r_bromii_hmp_qp_syn, one_epoch_14, r_bromii_complete_two_epoch, r_bromii_complete_three_epoch, r_bromii_hmp_qp_nonsyn, r_bromii_complete_gamma_dfe, r_bromii_complete_neugamma_dfe) + ggtitle('R. bromii (Downsampled to 14)')
compare_hmp_sfs(a_muciniphila_hmp_qp_syn, one_epoch_14, a_muciniphila_complete_two_epoch, a_muciniphila_complete_three_epoch, a_muciniphila_hmp_qp_nonsyn, a_muciniphila_complete_gamma_dfe, a_muciniphila_complete_neugamma_dfe) + ggtitle('A. muciniphila (Downsampled to 14)')
compare_hmp_sfs(a_finegoldii_hmp_qp_syn, one_epoch_14, a_finegoldii_complete_two_epoch, a_finegoldii_complete_three_epoch, a_finegoldii_hmp_qp_nonsyn, a_finegoldii_complete_gamma_dfe, a_finegoldii_complete_neugamma_dfe) + ggtitle('A. finegoldii (Downsampled to 14)')
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_onderdonkii_dfe_params),
melt(a_putredinis_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_caccae_dfe_params),
melt(b_cellulosilyticus_dfe_params),
melt(b_fragilis_dfe_params),
melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
melt(b_uniformis_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
melt(d_invisus_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(o_sp_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params),
melt(r_bromii_dfe_params)
)
# dfe_df$value[dfe_df$value <= 1e-16]$value = 1e-16
dfe_df$value[dfe_df$value <= 1e-14] = 1e-14
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
compare_hmp_sfs(r_bromii_hmp_qp_syn, one_epoch_14, r_bromii_complete_two_epoch, r_bromii_complete_three_epoch, r_bromii_hmp_qp_nonsyn, r_bromii_complete_gamma_dfe, r_bromii_complete_neugamma_dfe) + ggtitle('R. bromii (Downsampled to 14)')
compare_hmp_sfs(a_muciniphila_hmp_qp_syn, one_epoch_14, a_muciniphila_complete_two_epoch, a_muciniphila_complete_three_epoch, a_muciniphila_hmp_qp_nonsyn, a_muciniphila_complete_gamma_dfe, a_muciniphila_complete_neugamma_dfe) + ggtitle('A. muciniphila (Downsampled to 14)')
compare_hmp_sfs(a_finegoldii_hmp_qp_syn, one_epoch_14, a_finegoldii_complete_two_epoch, a_finegoldii_complete_three_epoch, a_finegoldii_hmp_qp_nonsyn, a_finegoldii_complete_gamma_dfe, a_finegoldii_complete_neugamma_dfe) + ggtitle('A. finegoldii (Downsampled to 14)')
compare_hmp_sfs(a_onderdonkii_hmp_qp_syn, one_epoch_14, a_onderdonkii_complete_two_epoch, a_onderdonkii_complete_three_epoch, a_onderdonkii_hmp_qp_nonsyn, a_onderdonkii_complete_gamma_dfe, a_onderdonkii_complete_neugamma_dfe) + ggtitle('A. onderdonkii (Downsampled to 14)')
compare_hmp_sfs(a_putredinis_hmp_qp_syn, one_epoch_14, a_putredinis_complete_two_epoch, a_putredinis_complete_three_epoch, a_putredinis_hmp_qp_nonsyn, a_putredinis_complete_gamma_dfe, a_putredinis_complete_neugamma_dfe) + ggtitle('A. putredinis (Downsampled to 14)')
compare_hmp_sfs(a_shahii_hmp_qp_syn, one_epoch_14, a_shahii_complete_two_epoch, a_shahii_complete_three_epoch, a_shahii_hmp_qp_nonsyn, a_shahii_complete_gamma_dfe, a_shahii_complete_neugamma_dfe) + ggtitle('Alistipes shahii (Downsampled to 14)')
mean(dfe_df$value)
dfe_df
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggscatter(two_epoch_nu_tau, x="nu", y="time_low", fill="species", color="species") + geom_vline(xintercept=1) +
ylab('Time in Years') +
xlab('Ratio of current to ancestral population size')
