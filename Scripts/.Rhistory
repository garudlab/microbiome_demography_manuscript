p21_core_dfe + p21_acc_dfe +
p22_core_dfe + p22_acc_dfe +
plot_layout(ncol=1)
core_accessory_comparison
# 3200 x 16000
# Reorder area distribution
# Take out E. eligens
# Rescale legends to match font size
# Legend in upper right corner of figure
# Nucleotide diversity
pi_summary_df = data.frame(read.csv('../Analysis/summarized_pi.csv', header=TRUE))
names(pi_summary_df) = c('species', 'Cohort', 'average_pi', 'num_sites',
'num_samples', 'aggregate_across_pi', 'pairwise_across_pi')
list_iid = c('Bifidobacterium_longum_57796',
'Blautia_wexlerae_56130',
'Butyrivibrio_crossotus_61674',
'Escherichia_coli_58110',
'Eubacterium_eligens_61678',
'Faecalibacterium_cf_62236',
'Faecalibacterium_prausnitzii_57453',
'Faecalibacterium_prausnitzii_61481',
'Faecalibacterium_prausnitzii_62201',
'Oscillibacter_sp_60799',
'Prevotella_copri_61740',
'Roseburia_inulinivorans_61943',
'Ruminococcus_bromii_62047')
over_iid_df = subset(pi_summary_df, species %in% list_iid)
position_jitterdodge(
jitter.width = NULL,
jitter.height = 0,
dodge.width = 0.5,
seed = NA
)
# pairwise_pi_comparison_10 + stat_compare_means(label = "p.signif", method = "t.test")
over_iid_df$ordered_pi = 0
over_iid_df[over_iid_df$species=='Bifidobacterium_longum_57796' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Bifidobacterium_longum_57796' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Bifidobacterium_longum_57796' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Bifidobacterium_longum_57796' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Blautia_wexlerae_56130' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Blautia_wexlerae_56130' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Blautia_wexlerae_56130' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Blautia_wexlerae_56130' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Butyrivibrio_crossotus_61674' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Butyrivibrio_crossotus_61674' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Butyrivibrio_crossotus_61674' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Butyrivibrio_crossotus_61674' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Eubacterium_eligens_61678' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Eubacterium_eligens_61678' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Eubacterium_eligens_61678' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Eubacterium_eligens_61678' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Escherichia_coli_58110' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Escherichia_coli_58110' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Escherichia_coli_58110' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Escherichia_coli_58110' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Faecalibacterium_cf_62236' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Faecalibacterium_cf_62236' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Faecalibacterium_cf_62236' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Faecalibacterium_cf_62236' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_61481' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_61481' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_61481' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_61481' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_57453' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_57453' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_57453' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_57453' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_62201' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_62201' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_62201' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Faecalibacterium_prausnitzii_62201' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Oscillibacter_sp_60799' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Oscillibacter_sp_60799' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Oscillibacter_sp_60799' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Oscillibacter_sp_60799' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Prevotella_copri_61740' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Prevotella_copri_61740' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Prevotella_copri_61740' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Prevotella_copri_61740' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Roseburia_inulinivorans_61943' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Roseburia_inulinivorans_61943' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Roseburia_inulinivorans_61943' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Roseburia_inulinivorans_61943' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Ruminococcus_bromii_62047' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Ruminococcus_bromii_62047' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Ruminococcus_bromii_62047' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Ruminococcus_bromii_62047' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Ruminococcus_bromii_62047' & over_iid_df$Cohort==' HMP', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Ruminococcus_bromii_62047' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
over_iid_df[over_iid_df$species=='Ruminococcus_bromii_62047' & over_iid_df$Cohort==' African', ]$ordered_pi =
mean(over_iid_df[over_iid_df$species=='Ruminococcus_bromii_62047' & over_iid_df$Cohort==' African', ]$pairwise_across_pi)
unique(over_iid_df$species)
over_iid_df$species[over_iid_df$species == 'Bifidobacterium_longum_57796'] = 'Bifidobacterium longum'
over_iid_df$species[over_iid_df$species == 'Blautia_wexlerae_56130'] = 'Blautia wexlerae'
over_iid_df$species[over_iid_df$species == 'Butyrivibrio_crossotus_61674'] = 'Butyrivibrio crossotus'
over_iid_df$species[over_iid_df$species == 'Eubacterium_eligens_61678'] = 'Eubacterium eligens'
over_iid_df$species[over_iid_df$species == 'Escherichia_coli_58110'] = 'Escherichia coli'
over_iid_df$species[over_iid_df$species == 'Faecalibacterium_prausnitzii_61481'] = 'Faecalibacterium prausnitzii (61481)'
over_iid_df$species[over_iid_df$species == 'Faecalibacterium_prausnitzii_57453'] = 'Faecalibacterium prausnitzii (57453)'
over_iid_df$species[over_iid_df$species == 'Faecalibacterium_prausnitzii_62201'] = 'Faecalibacterium prausnitzii (62201)'
over_iid_df$species[over_iid_df$species == 'Faecalibacterium_cf_62236'] = 'Faecalibacterium cf'
over_iid_df$species[over_iid_df$species == 'Oscillibacter_sp_60799'] = 'Oscillibacter species'
over_iid_df$species[over_iid_df$species == 'Prevotella_copri_61740'] = 'Prevotella copri'
over_iid_df$species[over_iid_df$species == 'Roseburia_inulinivorans_61943'] = 'Roseburia inulinovrans'
over_iid_df$species[over_iid_df$species == 'Ruminococcus_bromii_62047'] = 'Ruminococcus bromii'
better_pi_comparison_iid <- ggplot(data=over_iid_df, aes(x=reorder(species, ordered_pi), y=average_pi, fill=Cohort)) +
geom_boxplot(aes(fill=Cohort), outlier.shape=NA) +
geom_point(pch = 21, position = position_jitterdodge(), size=1.5) +
geom_point(aes(x=species, y=pairwise_across_pi, color=Cohort), size=4, shape=16, position=position_dodge(width=0.75)) +
theme_bw() +
theme(plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
theme(axis.text.x = element_text(size=rel(1.5), angle=40, vjust=1.0, hjust=1)) +
theme(axis.text.y = element_text(size=rel(1.5))) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_text(size=rel(1.5))) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x,)),
limits = c(0.0001, 0.2)) +
scale_fill_manual(values=c('dodgerblue3', 'goldenrod1')) +
scale_color_manual(values=c('dodgerblue3', 'goldenrod1')) +
theme(axis.text.x=element_text(face="italic")) +
theme(legend.position = "none") +
xlab('Species') +
ylab('Nucleotide diversity') +
# ggtitle('Distribution of within and between-host nucleotide diversity across cohorts') +
# stat_compare_means(method='wilcox.test', label='p.signif', size=6)
stat_compare_means(method='wilcox.test', size=2)
better_pi_comparison_iid
distinct_iid_df = distinct(over_iid_df, pairwise_across_pi, .keep_all=TRUE)
distinct_df = distinct(pi_summary_df, pairwise_across_pi, .keep_all=TRUE)
HMP_distinct = distinct_df[distinct_df$Cohort==' HMP', ]$pairwise_across_pi
African_distinct = distinct_df[distinct_df$Cohort==' African', ]$pairwise_across_pi
HMP_distinct_pairwise = distinct_iid_df[distinct_iid_df$Cohort==' HMP', ]$pairwise_across_pi
African_distinct_pairwise = distinct_iid_df[distinct_iid_df$Cohort==' African', ]$pairwise_across_pi
wilcox.test(HMP_distinct_pairwise, African_distinct_pairwise, paired=TRUE, exact=TRUE)
wilcox.test(HMP_distinct, African_distinct, paired=FALSE, exact=TRUE)
hmp_summary_df = pi_summary_df[pi_summary_df$Cohort==' HMP', ]
afr_summary_df = pi_summary_df[pi_summary_df$Cohort==' African', ]
# Number of species in each cohort
length(unique(hmp_summary_df$species))
length(unique(afr_summary_df$species))
# Number of shared species
sum(unique(afr_summary_df$species) %in% unique(hmp_summary_df$species))
afr_species_freq = data.frame(table(afr_summary_df$species))
hmp_species_freq = data.frame(table(hmp_summary_df$species))
over_5_afr_species = afr_species_freq[afr_species_freq$Freq > 5, ]$Var1
over_5_hmp_species = hmp_species_freq[hmp_species_freq$Freq > 5, ]$Var1
over_5_species = unique(c(over_5_afr_species, over_5_hmp_species))
over_5_species_df = pi_summary_df[pi_summary_df$species %in% over_5_species, ]
# over_5_species_df = drop_duplicates(over_5_species_df, keep=False)
over_5_species_df = over_5_species_df[!duplicated(over_5_species_df$pairwise_across_pi), ]
over_5_species_df = over_5_species_df[order(over_5_species_df$species), ]
over_5_species_df
compare_iid_over_5_means <- ggplot(data=over_5_species_df, aes(x=Cohort, y=pairwise_across_pi, fill=Cohort)) +
geom_boxplot(aes(fill=Cohort), outlier.shape=NA) +
geom_point(pch = 21, position = position_jitterdodge(), size=1.5) +
theme_bw() +
theme(plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
theme(axis.text.x = element_text(size=rel(1.5), angle=40, vjust=1.0, hjust=1)) +
theme(axis.text.y = element_text(size=rel(1.5))) +
theme(axis.title.x = element_blank()) +
theme(axis.title.y = element_blank()) +
theme(legend.text = element_text(size=rel(1.5))) +
theme(legend.title = element_text(size=rel(1.5))) +
scale_fill_manual(values=c('dodgerblue3', 'goldenrod1')) +
scale_color_manual(values=c('dodgerblue3', 'goldenrod1')) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x,)),
limits = c(0.0001, 0.2)) +
ylab('Mean Nucleotide diversity per Species') +
# ylim(0, 0.03) +
stat_compare_means(method='wilcox.test', label='p.signif', size=6)
# ggtitle('Mean Nucleotide diversity per Species between Cohorts')
compare_iid_over_5_means
### Figure 1
better_pi_comparison_iid + compare_iid_over_5_means + plot_layout(widths = c(3, 1))
# 1500 x 900 dimensions for saved image
# Plot DFE Grid
DFE_grid_file_list = c(
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_onderdonkii_55464_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_putredinis_61533_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_shahii_62199_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroidales_bacterium_58650_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_caccae_53434_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_fragilis_54507_likelihood_surface.csv',
# '../Analysis/cross_species_dfe/Bacteroides_ovatus_58035_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_stercoris_56735_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_uniformis_57318_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_vulgatus_57955_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Barnesiella_intestinihominis_62208_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Dialister_invisus_61905_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_eligens_61678_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_rectale_56927_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Odoribacter_splanchnicus_62174_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Oscillibacter_sp_60799_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_distasonis_56985_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_merdae_56972_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Phascolarctobacterium_sp_59817_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Prevotella_copri_61740_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bicirculans_59300_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bromii_62047_likelihood_surface.csv'
)
for (species in DFE_grid_file_list) {
print(species)
find_dfe_mle(species)
}
# test
cross_species_dfe_comparison(
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv')
dfe_comparison_matrix = matrix(, nrow=27, ncol=27)
for (i in 1:27) {
for (j in 1:27) {
print(DFE_grid_file_list[i])
print(DFE_grid_file_list[j])
comparison = cross_species_dfe_comparison(DFE_grid_file_list[i], DFE_grid_file_list[j])
print(comparison)
dfe_comparison_matrix[i, j] = comparison
}
}
phylogenetic_levels
DFE_grid_file_list = c(
'../Analysis/cross_species_dfe/Bacteroidales_bacterium_58650_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_putredinis_61533_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_onderdonkii_55464_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_shahii_62199_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Odoribacter_splanchnicus_62174_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_distasonis_56985_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_merdae_56972_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Prevotella_copri_61740_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_fragilis_54507_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_stercoris_56735_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_uniformis_57318_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_caccae_53434_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_vulgatus_57955_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Barnesiella_intestinihominis_62208_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Dialister_invisus_61905_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Phascolarctobacterium_sp_59817_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_eligens_61678_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_rectale_56927_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Oscillibacter_sp_60799_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bromii_62047_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bicirculans_59300_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_likelihood_surface.csv'
)
DFE_grid_file_list = c(
'../Analysis/cross_species_dfe/Bacteroidales_bacterium_58650_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_putredinis_61533_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_onderdonkii_55464_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_shahii_62199_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Odoribacter_splanchnicus_62174_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_distasonis_56985_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_merdae_56972_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Prevotella_copri_61740_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_fragilis_54507_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_stercoris_56735_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_uniformis_57318_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_caccae_53434_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_vulgatus_57955_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Barnesiella_intestinihominis_62208_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Dialister_invisus_61905_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Phascolarctobacterium_sp_59817_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_eligens_61678_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_rectale_56927_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Oscillibacter_sp_60799_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bromii_62047_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bicirculans_59300_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_likelihood_surface.csv'
)
dfe_comparison_matrix = matrix(, nrow=27, ncol=27)
DFE_grid_file_list = c(
'../Analysis/cross_species_dfe/Bacteroidales_bacterium_58650_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_putredinis_61533_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_onderdonkii_55464_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_shahii_62199_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Odoribacter_splanchnicus_62174_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_distasonis_56985_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_merdae_56972_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Prevotella_copri_61740_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_fragilis_54507_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_stercoris_56735_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_uniformis_57318_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_caccae_53434_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_vulgatus_57955_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Barnesiella_intestinihominis_62208_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Dialister_invisus_61905_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Phascolarctobacterium_sp_59817_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_eligens_61678_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_rectale_56927_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Oscillibacter_sp_60799_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bromii_62047_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bicirculans_59300_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_likelihood_surface.csv'
)
DFE_grid_file_list_constant_s = c(
'../Analysis/cross_species_dfe/Bacteroidales_bacterium_58650_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_putredinis_61533_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_finegoldii_56071_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_onderdonkii_55464_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Alistipes_shahii_62199_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Odoribacter_splanchnicus_62174_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_distasonis_56985_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Parabacteroides_merdae_56972_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Prevotella_copri_61740_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_fragilis_54507_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_cellulosilyticus_58046_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_stercoris_56735_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_uniformis_57318_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_thetaiotaomicron_56941_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_xylanisolvens_57185_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_caccae_53434_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Bacteroides_vulgatus_57955_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Barnesiella_intestinihominis_62208_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Akkermansia_muciniphila_55290_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Dialister_invisus_61905_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Phascolarctobacterium_sp_59817_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_eligens_61678_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Eubacterium_rectale_56927_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Oscillibacter_sp_60799_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bromii_62047_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Ruminococcus_bicirculans_59300_constant_s_likelihood_surface.csv',
'../Analysis/cross_species_dfe/Faecalibacterium_prausnitzii_57453_constant_s_likelihood_surface.csv'
)
dfe_comparison_matrix
for (i in 1:27) {
for (j in i:27) {  # This change ensures only the upper right triangle is compared
print(DFE_grid_file_list[i])
print(DFE_grid_file_list[j])
comparison = cross_species_dfe_comparison(DFE_grid_file_list[i], DFE_grid_file_list[j])
print(comparison)
dfe_comparison_matrix[i, j] = comparison
dfe_comparison_matrix[j, i] = comparison  # Mirror the value across the diagonal
}
}
dfe_comparison_matrix
row.names(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
write.csv(dfe_comparison_matrix, '../Analysis/cross_species_dfe/dfe_comparison_matrix.csv')
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
dfe_comparison_matrix = dfe_comparison_matrix[, -1]
rownames(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
pheatmap(dfe_comparison_matrix,
cluster_rows = F, cluster_cols = F, fontsize_number = 10,
display_numbers = T,
show_colnames     = FALSE,
show_rownames     = FALSE,
color = colorRampPalette(c('red','orange', 'yellow', 'white'), bias=0.05)(100),
legend=TRUE)
dfe_constant_s_matrix = matrix(, nrow=27, ncol=27)
dfe_constant_s_matrix = matrix(, nrow=27, ncol=27)
for (i in 1:27) {
for (j in i:27) {  # This change ensures only the upper right triangle is compared
print(DFE_grid_file_list_constant_s[i])
print(DFE_grid_file_list_constant_s[j])
comparison = cross_species_dfe_comparison(DFE_grid_file_list_constant_s[i], DFE_grid_file_list_constant_s[j])
print(comparison)
dfe_constant_s_matrix[i, j] = comparison
dfe_constant_s_matrix[j, i] = comparison  # Mirror the value across the diagonal
}
}
dfe_constant_s_matrix
row.names(dfe_constant_s_matrix) = phylogenetic_levels
colnames(dfe_constant_s_matrix) = phylogenetic_levels
dfe_constant_s_matrix
write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
dfe_comparison_matrix = dfe_comparison_matrix[, -1]
rownames(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
dfe_constant_s_matrix = read.csv('../Analysis/cross_species_dfe/dfe_constant_s_matrix.csv', header=TRUE)
dfe_constant_s_matrix = dfe_constant_s_matrix[, -1]
rownames(dfe_constant_s_matrix) = phylogenetic_levels
dfe_constant_s_matrix
#     print(comparison)
#     dfe_constant_s_matrix[i, j] = comparison
#     dfe_constant_s_matrix[j, i] = comparison  # Mirror the value across the diagonal
#   }
# }
#
# row.names(dfe_constant_s_matrix) = phylogenetic_levels
# colnames(dfe_constant_s_matrix) = phylogenetic_levels
# dfe_constant_s_matrix
#
write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
#     print(comparison)
#     dfe_constant_s_matrix[i, j] = comparison
#     dfe_constant_s_matrix[j, i] = comparison  # Mirror the value across the diagonal
#   }
# }
#
# row.names(dfe_constant_s_matrix) = phylogenetic_levels
# colnames(dfe_constant_s_matrix) = phylogenetic_levels
# dfe_constant_s_matrix
#
write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
dfe_constant_s_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv', header=TRUE)
dfe_constant_s_matrix = dfe_constant_s_matrix[, -1]
rownames(dfe_constant_s_matrix) = phylogenetic_levels
colnames(dfe_constant_s_matrix) = phylogenetic_levels
dfe_constant_s_matrix
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
dfe_comparison_matrix = dfe_comparison_matrix[, -1]
rownames(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
dfe_constant_s_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv', header=TRUE)
dfe_constant_s_matrix = dfe_constant_s_matrix[, -1]
rownames(dfe_constant_s_matrix) = phylogenetic_levels
colnames(dfe_constant_s_matrix) = phylogenetic_levels
dfe_constant_s_matrix
dfe_constant_s_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv', header=TRUE)
dfe_constant_s_matrix = dfe_constant_s_matrix[, -1]
rownames(dfe_constant_s_matrix) = phylogenetic_levels
colnames(dfe_constant_s_matrix) = phylogenetic_levels
dfe_constant_s_matrix
length(dfe_constant_s_matrix)
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
#dfe_comparison_matrix = dfe_comparison_matrix[, -1]
rownames(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
View(dfe_comparison_matrix)
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
dfe_comparison_matrix = dfe_comparison_matrix[, -1]
rownames(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
dfe_constant_s_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv', header=TRUE)
dfe_constant_s_matrix
b_bacterium_constant_s = numeric(27)
for (i in 1:27) {
b_bacterium_constant_s[i] = cross_species_dfe_comparison(DFE_grid_file_list_constant_s[1], DFE_grid_file_list_constant_s[i])
}
b_bacterium_constant_s
dfe_constant_s_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv', header=TRUE)
dfe_constant_s_matrix[, 1] = b_bacterium_constant_s
dfe_constant_s_matrix
rownames(dfe_constant_s_matrix) = phylogenetic_levels
colnames(dfe_constant_s_matrix) = phylogenetic_levels
dfe_constant_s_matrix
write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
dfe_constant_s_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv', header=TRUE)
dfe_constant_s_matrix
dfe_constant_s_matrix = dfe_constant_s_matrix[, -1]
rownames(dfe_constant_s_matrix) = phylogenetic_levels
colnames(dfe_constant_s_matrix) = phylogenetic_levels
dfe_constant_s_matrix
pheatmap(dfe_comparison_matrix,
cluster_rows = F, cluster_cols = F, fontsize_number = 10,
display_numbers = T,
show_colnames     = FALSE,
show_rownames     = FALSE,
color = colorRampPalette(c('red','orange', 'yellow', 'white'), bias=0.05)(100),
legend=TRUE)
pheatmap(dfe_constant_s_matrix,
cluster_rows = F, cluster_cols = F, fontsize_number = 10,
display_numbers = T,
show_colnames     = FALSE,
show_rownames     = FALSE,
color = colorRampPalette(c('red','orange', 'yellow', 'white'), bias=0.05)(100),
legend=TRUE)
pheatmap(dfe_constant_s_matrix,
cluster_rows = F, cluster_cols = F, fontsize_number = 10,
display_numbers = T,
show_colnames     = FALSE,
show_rownames     = FALSE,
color = colorRampPalette(c('red','orange', 'yellow', 'white'), bias=0.05)(100),
legend=TRUE)
pheatmap(dfe_comparison_matrix,
cluster_rows = F, cluster_cols = F, fontsize_number = 10,
display_numbers = T,
show_colnames     = FALSE,
show_rownames     = FALSE,
color = colorRampPalette(c('red','orange', 'yellow', 'white'), bias=0.05)(100),
legend=TRUE)
pheatmap(dfe_constant_s_matrix,
cluster_rows = F, cluster_cols = F, fontsize_number = 10,
display_numbers = T,
show_colnames     = FALSE,
show_rownames     = FALSE,
color = colorRampPalette(c('red','orange', 'yellow', 'white'), bias=0.05)(100),
legend=TRUE)
