param_string_low = readLines(this_file)[5]
param_string_low = strsplit(param_string_low, split=': ')
param_string_low = unlist(param_string_low)[2]
param_string_low = str_sub(param_string_low, 2, -3)
param_string_low = unlist(strsplit(param_string_low, ' '))
param_string_low = as.numeric(param_string_low)
gamma_scale_low = param_string_low[2]
gamma_dfe_bound_high = compute_dfe_height(shape=gamma_shape, scale=gamma_scale_high)
gamma_dfe_bound_low = compute_dfe_height(shape=gamma_shape, scale=gamma_scale_low)
gamma_dfe_dist_high = rgamma(10000, shape=gamma_shape, scale=gamma_scale_high)
gamma_dfe_dist_low = rgamma(10000, shape=gamma_shape, scale=gamma_scale_low)
param_string_high = readLines(this_file)[11]
param_string_high = strsplit(param_string_high, split=': ')
param_string_high = unlist(param_string_high)[2]
param_string_high = str_sub(param_string_high, 2, -3)
param_string_high = unlist(strsplit(param_string_high, ' '))
param_string_high = as.numeric(param_string_high)
neugamma_proportion = param_string_high[1]
neugamma_shape = param_string_high[2]
neugamma_scale_high = param_string_high[3]
param_string_low = readLines(this_file)[12]
param_string_low = strsplit(param_string_low, split=': ')
param_string_low = unlist(param_string_low)[2]
param_string_low = str_sub(param_string_low, 2, -3)
param_string_low = unlist(strsplit(param_string_low, ' '))
param_string_low = as.numeric(param_string_low)
neugamma_scale_low = param_string_low[3]
neugamma_dfe_bound_high = compute_dfe_height(shape=neugamma_shape, scale=neugamma_scale_high)
neugamma_dfe_bound_low = compute_dfe_height(shape=neugamma_shape, scale=neugamma_scale_low)
neugamma_dfe_dist_high = rgamma(10000, shape=neugamma_shape, scale=neugamma_scale_high)
neugamma_dfe_dist_low = rgamma(10000, shape=neugamma_shape, scale=neugamma_scale_low)
zeroed_sites = as.integer(10000 * neugamma_proportion)
neugamma_dfe_dist_high[1:zeroed_sites] = 0
neugamma_dfe_dist_low[1:zeroed_sites] = 0
dfe_df = data.frame(gamma_dfe_dist_high,
gamma_dfe_dist_low,
neugamma_dfe_dist_high,
neugamma_dfe_dist_low)
dfe_df[dfe_df < 1e-20] = 1e-19
return(dfe_df)
}
# DFE Comparison
a_muciniphila_dfe_params = read_dfe_params('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
install.packages("stringr")
library(stringr)
read_dfe_params = function(input_dfe_file) {
## Reads input DFE from output *inferred_DFE.txt
this_file = file(input_dfe_file) # Open file
on.exit(close(this_file)) # Close when done
# Parse file and string manipulation
param_string_high = readLines(this_file)[4]
param_string_high = strsplit(param_string_high, split=': ')
param_string_high = unlist(param_string_high)[2]
param_string_high = str_sub(param_string_high, 2, -3)
param_string_high = str_squish(param_string_high)
param_string_high = unlist(strsplit(param_string_high, ' '))
param_string_high = as.numeric(param_string_high)
print(param_string_high)
gamma_shape = param_string_high[1]
gamma_scale_high = param_string_high[2]
param_string_low = readLines(this_file)[5]
param_string_low = strsplit(param_string_low, split=': ')
param_string_low = unlist(param_string_low)[2]
param_string_low = str_sub(param_string_low, 2, -3)
param_string_low = str_squish(param_string_low)
param_string_low = unlist(strsplit(param_string_low, ' '))
param_string_low = as.numeric(param_string_low)
gamma_scale_low = param_string_low[2]
gamma_dfe_bound_high = compute_dfe_height(shape=gamma_shape, scale=gamma_scale_high)
gamma_dfe_bound_low = compute_dfe_height(shape=gamma_shape, scale=gamma_scale_low)
gamma_dfe_dist_high = rgamma(10000, shape=gamma_shape, scale=gamma_scale_high)
gamma_dfe_dist_low = rgamma(10000, shape=gamma_shape, scale=gamma_scale_low)
param_string_high = readLines(this_file)[11]
param_string_high = strsplit(param_string_high, split=': ')
param_string_high = unlist(param_string_high)[2]
param_string_high = str_sub(param_string_high, 2, -3)
param_string_high = str_squish(param_string_high)
param_string_high = unlist(strsplit(param_string_high, ' '))
param_string_high = as.numeric(param_string_high)
neugamma_proportion = param_string_high[1]
neugamma_shape = param_string_high[2]
neugamma_scale_high = param_string_high[3]
param_string_low = readLines(this_file)[12]
param_string_low = strsplit(param_string_low, split=': ')
param_string_low = unlist(param_string_low)[2]
param_string_low = str_sub(param_string_low, 2, -3)
param_string_low = str_squish(param_string_low)
param_string_low = unlist(strsplit(param_string_low, ' '))
param_string_low = as.numeric(param_string_low)
neugamma_scale_low = param_string_low[3]
neugamma_dfe_bound_high = compute_dfe_height(shape=neugamma_shape, scale=neugamma_scale_high)
neugamma_dfe_bound_low = compute_dfe_height(shape=neugamma_shape, scale=neugamma_scale_low)
neugamma_dfe_dist_high = rgamma(10000, shape=neugamma_shape, scale=neugamma_scale_high)
neugamma_dfe_dist_low = rgamma(10000, shape=neugamma_shape, scale=neugamma_scale_low)
zeroed_sites = as.integer(10000 * neugamma_proportion)
neugamma_dfe_dist_high[1:zeroed_sites] = 0
neugamma_dfe_dist_low[1:zeroed_sites] = 0
dfe_df = data.frame(gamma_dfe_dist_high,
gamma_dfe_dist_low,
neugamma_dfe_dist_high,
neugamma_dfe_dist_low)
dfe_df[dfe_df < 1e-20] = 1e-19
return(dfe_df)
}
# DFE Comparison
a_muciniphila_dfe_params = read_dfe_params('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_muciniphila_dfe_params$species = 'A. muciniphila'
read_dfe_params = function(input_dfe_file) {
## Reads input DFE from output *inferred_DFE.txt
this_file = file(input_dfe_file) # Open file
on.exit(close(this_file)) # Close when done
# Parse file and string manipulation
param_string_high = readLines(this_file)[4]
param_string_high = strsplit(param_string_high, split=': ')
param_string_high = unlist(param_string_high)[2]
param_string_high = str_sub(param_string_high, 2, -3)
param_string_high = str_squish(param_string_high)
param_string_high = unlist(strsplit(param_string_high, ' '))
param_string_high = as.numeric(param_string_high)
gamma_shape = param_string_high[1]
gamma_scale_high = param_string_high[2]
param_string_low = readLines(this_file)[5]
param_string_low = strsplit(param_string_low, split=': ')
param_string_low = unlist(param_string_low)[2]
param_string_low = str_sub(param_string_low, 2, -3)
param_string_low = str_squish(param_string_low)
param_string_low = unlist(strsplit(param_string_low, ' '))
param_string_low = as.numeric(param_string_low)
gamma_scale_low = param_string_low[2]
gamma_dfe_bound_high = compute_dfe_height(shape=gamma_shape, scale=gamma_scale_high)
gamma_dfe_bound_low = compute_dfe_height(shape=gamma_shape, scale=gamma_scale_low)
gamma_dfe_dist_high = rgamma(10000, shape=gamma_shape, scale=gamma_scale_high)
gamma_dfe_dist_low = rgamma(10000, shape=gamma_shape, scale=gamma_scale_low)
param_string_high = readLines(this_file)[11]
param_string_high = strsplit(param_string_high, split=': ')
param_string_high = unlist(param_string_high)[2]
param_string_high = str_sub(param_string_high, 2, -3)
param_string_high = str_squish(param_string_high)
param_string_high = unlist(strsplit(param_string_high, ' '))
param_string_high = as.numeric(param_string_high)
neugamma_proportion = param_string_high[1]
neugamma_shape = param_string_high[2]
neugamma_scale_high = param_string_high[3]
param_string_low = readLines(this_file)[12]
param_string_low = strsplit(param_string_low, split=': ')
param_string_low = unlist(param_string_low)[2]
param_string_low = str_sub(param_string_low, 2, -3)
param_string_low = str_squish(param_string_low)
param_string_low = unlist(strsplit(param_string_low, ' '))
param_string_low = as.numeric(param_string_low)
neugamma_scale_low = param_string_low[3]
neugamma_dfe_bound_high = compute_dfe_height(shape=neugamma_shape, scale=neugamma_scale_high)
neugamma_dfe_bound_low = compute_dfe_height(shape=neugamma_shape, scale=neugamma_scale_low)
neugamma_dfe_dist_high = rgamma(10000, shape=neugamma_shape, scale=neugamma_scale_high)
neugamma_dfe_dist_low = rgamma(10000, shape=neugamma_shape, scale=neugamma_scale_low)
zeroed_sites = as.integer(10000 * neugamma_proportion)
neugamma_dfe_dist_high[1:zeroed_sites] = 0
neugamma_dfe_dist_low[1:zeroed_sites] = 0
dfe_df = data.frame(gamma_dfe_dist_high,
gamma_dfe_dist_low,
neugamma_dfe_dist_high,
neugamma_dfe_dist_low)
dfe_df[dfe_df < 1e-20] = 1e-19
return(dfe_df)
}
# DFE Comparison
a_muciniphila_dfe_params = read_dfe_params('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_muciniphila_dfe_params$species = 'A. muciniphila'
a_finegoldii_dfe_params = read_dfe_params('../Analysis/Alistipes_finegoldii_56071_downsampled_14/inferred_DFE.txt')
a_finegoldii_dfe_params$species = 'A. finegoldii'
a_onderdonkii_dfe_params = read_dfe_params('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/inferred_DFE.txt')
a_onderdonkii_dfe_params$species = 'A. onderdonkii (bad fit)'
a_putredinis_dfe_params = read_dfe_params('../Analysis/Alistipes_putredinis_61533_downsampled_14/inferred_DFE.txt')
a_putredinis_dfe_params$species = 'A. putredinis'
a_shahii_dfe_params = read_dfe_params('../Analysis/Alistipes_shahii_62199_downsampled_14/inferred_DFE.txt')
a_shahii_dfe_params$species = 'A. shahii'
compare_sfs_with_selection_count('../Analysis/Bacteroides_uniformis_57318_downsampled_14/') +
ggtitle('B. uniformis SFS Comparison')
a_shahii_dfe_params$species = 'A. shahii'
b_bacterium_dfe_params = read_dfe_params('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/inferred_DFE.txt')
b_bacterium_dfe_params$species = 'B. bacterium'
b_caccae_dfe_params = read_dfe_params('../Analysis/Bacteroides_caccae_53434_downsampled_14/inferred_DFE.txt')
b_caccae_dfe_params$species = 'B. caccae (bad fit)'
b_cellulosilyticus_dfe_params = read_dfe_params('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/inferred_DFE.txt')
b_cellulosilyticus_dfe_params$species = 'B. cellulosilyticus'
b_fragilis_dfe_params = read_dfe_params('../Analysis/Bacteroides_fragilis_54507_downsampled_14/inferred_DFE.txt')
b_fragilis_dfe_params$species = 'B. fragilis'
b_ovatus_dfe_params = read_dfe_params('../Analysis/Bacteroides_ovatus_58035_downsampled_14/inferred_DFE.txt')
b_ovatus_dfe_params$species = 'B. ovatus'
b_stercoris_dfe_params = read_dfe_params('../Analysis/Bacteroides_stercoris_56735_downsampled_14/inferred_DFE.txt')
b_stercoris_dfe_params$species = 'B. stercoris'
b_thetaiotaomicron_dfe_params = read_dfe_params('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/inferred_DFE.txt')
b_thetaiotaomicron_dfe_params$species = 'B. thetaiotaomicron'
b_uniformis_dfe_params = read_dfe_params('../Analysis/Bacteroides_uniformis_57318_downsampled_14/inferred_DFE.txt')
b_uniformis_dfe_params$species = 'B. uniformis'
b_vulgatus_dfe_params = read_dfe_params('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/inferred_DFE.txt')
b_vulgatus_dfe_params$species = 'B. vulgatus'
b_xylanisolvens_dfe_params = read_dfe_params('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/inferred_DFE.txt')
b_xylanisolvens_dfe_params$species = 'B. xylanisolvens'
b_intestinihominis_dfe_params = read_dfe_params('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/inferred_DFE.txt')
b_intestinihominis_dfe_params$species = 'B. intestinihominis'
d_invisus_dfe_params = read_dfe_params('../Analysis/Dialister_invisus_61905_downsampled_14/inferred_DFE.txt')
d_invisus_dfe_params$species = 'D. invisus (bad fit)'
e_eligens_dfe_params = read_dfe_params('../Analysis/Eubacterium_eligens_61678_downsampled_14/inferred_DFE.txt')
e_eligens_dfe_params$species = 'E. eligens'
e_rectale_dfe_params = read_dfe_params('../Analysis/Eubacterium_rectale_56927_downsampled_14/inferred_DFE.txt')
e_rectale_dfe_params$species = 'E. rectale'
f_prausnitzii_dfe_params = read_dfe_params('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/inferred_DFE.txt')
f_prausnitzii_dfe_params$species = 'F. prausnitzii'
o_splanchnicus_dfe_params = read_dfe_params('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/inferred_DFE.txt')
o_splanchnicus_dfe_params$species = 'O. splanchnicus'
o_sp_dfe_params = read_dfe_params('../Analysis/Oscillibacter_sp_60799_downsampled_14/inferred_DFE.txt')
o_sp_dfe_params$species = 'Oscillibacter sp. (bad fit)'
p_distasonis_dfe_params = read_dfe_params('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/inferred_DFE.txt')
p_distasonis_dfe_params$species = 'P. distasonis'
p_merdae_dfe_params = read_dfe_params('../Analysis/Parabacteroides_merdae_56972_downsampled_14/inferred_DFE.txt')
p_merdae_dfe_params$species = 'P. merdae'
p_sp_dfe_params = read_dfe_params('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_sp_dfe_params$species = 'Phascolarcobacterium species'
p_copri_dfe_params = read_dfe_params('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
p_copri_dfe_params$species = ''
r_bicirculans_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bicirculans_dfe_params$species = ''
r_bromii_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bromii_62047_downsampled_14/inferred_DFE.txt')
r_bromii_dfe_params$species = 'R. bromii (bad fit)'
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_onderdonkii_dfe_params),
melt(a_putredinis_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_caccae_dfe_params),
melt(b_cellulsilyticus_dfe_params),
melt(b_fragilis_dfe_params),
melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
melt(b_uniformis_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
melt(d_invisus_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(o_sp_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params),
melt(r_bromii_dfe_params)
)
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_onderdonkii_dfe_params),
melt(a_putredinis_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_caccae_dfe_params),
melt(b_cellulosilyticus_dfe_params),
melt(b_fragilis_dfe_params),
melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
melt(b_uniformis_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
melt(d_invisus_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(o_sp_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params),
melt(r_bromii_dfe_params)
)
dfe_df
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank())
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank())
p_copri_dfe_params = read_dfe_params('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
p_copri_dfe_params$species = 'P. copri'
r_bicirculans_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bicirculans_dfe_params$species = 'R. bicirculans'
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_onderdonkii_dfe_params),
melt(a_putredinis_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_caccae_dfe_params),
melt(b_cellulosilyticus_dfe_params),
melt(b_fragilis_dfe_params),
melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
melt(b_uniformis_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
melt(d_invisus_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(o_sp_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params),
melt(r_bromii_dfe_params)
)
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank())
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) + theme(legend.position = "none")
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 1.05) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) + theme(legend.position = "none")
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) + theme(legend.position = "none")
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) + theme(legend.position = "none") + ylab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) + theme(legend.position = "none") +
theme(axis.title.x = 'Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) + theme(legend.position = "none") +
theme(axis.title.x = element_text('Selective Effect'))
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) + theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=species, fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
