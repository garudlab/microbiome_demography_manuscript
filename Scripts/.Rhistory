theme(legend.position = "none") +
xlab('Selective Effect')
dfe_df$species
factor(dfe_df$species)
phylogenetic_levels = c(
'Akkermansia muciniphila',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes putredinis',
'Alistipes shahii',
'Bacteroidales bacterium',
'Bacteroides caccae',
'Bacteroides cellulosilyticus',
'Bacteroides fragilis',
'Bacteroides ovatus',
'Bacteroides stercoris',
'Bacteroides thetaiotaomicron',
'Bacteroides uniformis',
'Bacteroides vulgatus',
'Bacteroides xylanisolvens',
'Barnesiella intestinihominis',
'Odoribactersplanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Eubacterium eligens',
'Eubacterium rectale',
'Ruminococcus bicirculans',
'Ruminococcus bromii',
'Oscillibacter species',
'Dialister invisus',
'Phascolarbacterium species')
factor(dfe_df$species)
unique(factor(dfe_df$species))
temp = unique(factor(dfe_df$species))
unique(phylogenetic_levels)
phylogenetic_levels = c(
'Akkermansia muciniphila',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes putredinis',
'Alistipes shahii',
'Bacteroidales bacterium',
'Bacteroides caccae',
'Bacteroides cellulosilyticus',
'Bacteroides fragilis',
# 'Bacteroides ovatus',
'Bacteroides stercoris',
'Bacteroides thetaiotaomicron',
'Bacteroides uniformis',
'Bacteroides vulgatus',
'Bacteroides xylanisolvens',
'Barnesiella intestinihominis',
'Odoribactersplanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Eubacterium eligens',
'Eubacterium rectale',
'Ruminococcus bicirculans',
'Ruminococcus bromii',
'Oscillibacter species',
# 'Dialister invisus',
'Phascolarbacterium species')
unique(phylogenetic_levels)
temp
temp %in% phylogenetic_levels
phylogenetic_levels = c(
'Akkermansia muciniphila',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes putredinis',
'Alistipes shahii',
'Bacteroidales bacterium',
'Bacteroides caccae',
'Bacteroides cellulosilyticus',
'Bacteroides fragilis',
# 'Bacteroides ovatus',
'Bacteroides stercoris',
'Bacteroides thetaiotaomicron',
'Bacteroides uniformis',
'Bacteroides vulgatus',
'Bacteroides xylanisolvens',
'Barnesiella intestinihominis',
'Odoribactersplanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Eubacterium eligens',
'Eubacterium rectale',
'Faecalibacterium prausnitzii',
'Ruminococcus bicirculans',
'Ruminococcus bromii',
'Oscillibacter species',
# 'Dialister invisus',
'Phascolarctobacterium species')
temp %in% phylogenetic_levels
temp
p_sp_dfe_params = read_dfe_params('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_sp_dfe_params$species = 'Phascolarctobacterium species'
p_sp_dfe_params = read_dfe_params('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_sp_dfe_params$species = 'Phascolarctobacterium species'
p_copri_dfe_params = read_dfe_params('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
p_copri_dfe_params$species = 'Prevotella copri'
r_bicirculans_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bicirculans_dfe_params$species = 'Ruminococcus bicirculans'
r_bromii_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bromii_62047_downsampled_14/inferred_DFE.txt')
r_bromii_dfe_params$species = 'Ruminococcus bromii'
a_muciniphila_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_muciniphila_dfe_dadi_params$species = 'Akkermansia muciniphila'
a_finegoldii_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Alistipes_finegoldii_56071_downsampled_14/inferred_DFE.txt')
a_finegoldii_dfe_dadi_params$species = 'Alistipes finegoldii'
a_onderdonkii_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/inferred_DFE.txt')
a_onderdonkii_dfe_dadi_params$species = 'Alistipes onderdonkii'
a_putredinis_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Alistipes_putredinis_61533_downsampled_14/inferred_DFE.txt')
a_putredinis_dfe_dadi_params$species = 'Alistipes putredinis'
a_shahii_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Alistipes_shahii_62199_downsampled_14/inferred_DFE.txt')
a_shahii_dfe_dadi_params$species = 'Alistipes shahii'
b_bacterium_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/inferred_DFE.txt')
b_bacterium_dfe_dadi_params$species = 'Bacteroidales bacterium'
b_caccae_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_caccae_53434_downsampled_14/inferred_DFE.txt')
b_caccae_dfe_dadi_params$species = 'Bacteroides caccae'
b_cellulosilyticus_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/inferred_DFE.txt')
b_cellulosilyticus_dfe_dadi_params$species = 'Bacteroides cellulosilyticus'
b_fragilis_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_fragilis_54507_downsampled_14/inferred_DFE.txt')
b_fragilis_dfe_dadi_params$species = 'Bacteroides fragilis'
b_ovatus_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_ovatus_58035_downsampled_14/inferred_DFE.txt')
b_ovatus_dfe_dadi_params$species = 'Bacteroides ovatus'
b_stercoris_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_stercoris_56735_downsampled_14/inferred_DFE.txt')
b_stercoris_dfe_dadi_params$species = 'Bacteroides stercoris'
b_thetaiotaomicron_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/inferred_DFE.txt')
b_thetaiotaomicron_dfe_dadi_params$species = 'Bacteroides thetaiotaomicron'
b_uniformis_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_uniformis_57318_downsampled_14/inferred_DFE.txt')
b_uniformis_dfe_dadi_params$species = 'Bacteroides uniformis'
b_vulgatus_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/inferred_DFE.txt')
b_vulgatus_dfe_dadi_params$species = 'Bacteroides vulgatus'
b_xylanisolvens_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/inferred_DFE.txt')
b_xylanisolvens_dfe_dadi_params$species = 'Bacteroides xylanisolvens'
b_intestinihominis_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/inferred_DFE.txt')
# DFE Comparison
a_muciniphila_dfe_params = read_dfe_params('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_muciniphila_dfe_params$species = 'Akkermansia muciniphila'
a_finegoldii_dfe_params = read_dfe_params('../Analysis/Alistipes_finegoldii_56071_downsampled_14/inferred_DFE.txt')
a_finegoldii_dfe_params$species = 'Alistipes finegoldii'
a_onderdonkii_dfe_params = read_dfe_params('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/inferred_DFE.txt')
a_onderdonkii_dfe_params$species = 'Alistipes onderdonkii'
a_putredinis_dfe_params = read_dfe_params('../Analysis/Alistipes_putredinis_61533_downsampled_14/inferred_DFE.txt')
a_putredinis_dfe_params$species = 'Alistipes putredinis'
a_shahii_dfe_params = read_dfe_params('../Analysis/Alistipes_shahii_62199_downsampled_14/inferred_DFE.txt')
a_shahii_dfe_params$species = 'Alistipes shahii'
b_bacterium_dfe_params = read_dfe_params('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/inferred_DFE.txt')
b_bacterium_dfe_params$species = 'Bacteroidales bacterium'
b_caccae_dfe_params = read_dfe_params('../Analysis/Bacteroides_caccae_53434_downsampled_14/inferred_DFE.txt')
b_caccae_dfe_params$species = 'Bacteroides caccae'
b_cellulosilyticus_dfe_params = read_dfe_params('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/inferred_DFE.txt')
b_cellulosilyticus_dfe_params$species = 'Bacteroides cellulosilyticus'
b_fragilis_dfe_params = read_dfe_params('../Analysis/Bacteroides_fragilis_54507_downsampled_14/inferred_DFE.txt')
b_fragilis_dfe_params$species = 'Bacteroides fragilis'
b_ovatus_dfe_params = read_dfe_params('../Analysis/Bacteroides_ovatus_58035_downsampled_14/inferred_DFE.txt')
b_ovatus_dfe_params$species = 'Bacteroides ovatus'
b_stercoris_dfe_params = read_dfe_params('../Analysis/Bacteroides_stercoris_56735_downsampled_14/inferred_DFE.txt')
b_stercoris_dfe_params$species = 'Bacteroides stercoris'
b_thetaiotaomicron_dfe_params = read_dfe_params('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/inferred_DFE.txt')
b_thetaiotaomicron_dfe_params$species = 'Bacteroides thetaiotaomicron'
b_uniformis_dfe_params = read_dfe_params('../Analysis/Bacteroides_uniformis_57318_downsampled_14/inferred_DFE.txt')
b_uniformis_dfe_params$species = 'Bacteroides uniformis'
b_vulgatus_dfe_params = read_dfe_params('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/inferred_DFE.txt')
b_vulgatus_dfe_params$species = 'Bacteroides vulgatus'
b_xylanisolvens_dfe_params = read_dfe_params('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/inferred_DFE.txt')
b_xylanisolvens_dfe_params$species = 'Bacteroides xylanisolvens'
b_intestinihominis_dfe_params = read_dfe_params('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/inferred_DFE.txt')
b_intestinihominis_dfe_params$species = 'Barnesiella intestinihominis'
d_invisus_dfe_params = read_dfe_params('../Analysis/Dialister_invisus_61905_downsampled_14/inferred_DFE.txt')
d_invisus_dfe_params$species = 'Dialister invisus'
e_eligens_dfe_params = read_dfe_params('../Analysis/Eubacterium_eligens_61678_downsampled_14/inferred_DFE.txt')
e_eligens_dfe_params$species = 'Eubacterium eligens'
e_rectale_dfe_params = read_dfe_params('../Analysis/Eubacterium_rectale_56927_downsampled_14/inferred_DFE.txt')
e_rectale_dfe_params$species = 'Eubacterium rectale'
f_prausnitzii_dfe_params = read_dfe_params('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/inferred_DFE.txt')
f_prausnitzii_dfe_params$species = 'Faecalibacterium prausnitzii'
o_splanchnicus_dfe_params = read_dfe_params('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/inferred_DFE.txt')
o_splanchnicus_dfe_params$species = 'Odoribacter splanchnicus'
o_sp_dfe_params = read_dfe_params('../Analysis/Oscillibacter_sp_60799_downsampled_14/inferred_DFE.txt')
o_sp_dfe_params$species = 'Oscillibacter species'
p_distasonis_dfe_params = read_dfe_params('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/inferred_DFE.txt')
p_distasonis_dfe_params$species = 'Parabacteroides distasonis'
p_merdae_dfe_params = read_dfe_params('../Analysis/Parabacteroides_merdae_56972_downsampled_14/inferred_DFE.txt')
p_merdae_dfe_params$species = 'Parabacteroides merdae'
p_sp_dfe_params = read_dfe_params('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/inferred_DFE.txt')
p_sp_dfe_params$species = 'Phascolarctobacterium species'
p_copri_dfe_params = read_dfe_params('../Analysis/Prevotella_copri_61740_downsampled_14/inferred_DFE.txt')
p_copri_dfe_params$species = 'Prevotella copri'
r_bicirculans_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/inferred_DFE.txt')
r_bicirculans_dfe_params$species = 'Ruminococcus bicirculans'
r_bromii_dfe_params = read_dfe_params('../Analysis/Ruminococcus_bromii_62047_downsampled_14/inferred_DFE.txt')
r_bromii_dfe_params$species = 'Ruminococcus bromii'
a_muciniphila_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/inferred_DFE.txt')
a_muciniphila_dfe_dadi_params$species = 'Akkermansia muciniphila'
a_finegoldii_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Alistipes_finegoldii_56071_downsampled_14/inferred_DFE.txt')
a_finegoldii_dfe_dadi_params$species = 'Alistipes finegoldii'
a_onderdonkii_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/inferred_DFE.txt')
a_onderdonkii_dfe_dadi_params$species = 'Alistipes onderdonkii'
a_putredinis_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Alistipes_putredinis_61533_downsampled_14/inferred_DFE.txt')
a_putredinis_dfe_dadi_params$species = 'Alistipes putredinis'
a_shahii_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Alistipes_shahii_62199_downsampled_14/inferred_DFE.txt')
a_shahii_dfe_dadi_params$species = 'Alistipes shahii'
b_bacterium_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/inferred_DFE.txt')
b_bacterium_dfe_dadi_params$species = 'Bacteroidales bacterium'
b_caccae_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_caccae_53434_downsampled_14/inferred_DFE.txt')
b_caccae_dfe_dadi_params$species = 'Bacteroides caccae'
b_cellulosilyticus_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/inferred_DFE.txt')
b_cellulosilyticus_dfe_dadi_params$species = 'Bacteroides cellulosilyticus'
b_fragilis_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_fragilis_54507_downsampled_14/inferred_DFE.txt')
b_fragilis_dfe_dadi_params$species = 'Bacteroides fragilis'
b_ovatus_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_ovatus_58035_downsampled_14/inferred_DFE.txt')
b_ovatus_dfe_dadi_params$species = 'Bacteroides ovatus'
b_stercoris_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_stercoris_56735_downsampled_14/inferred_DFE.txt')
b_stercoris_dfe_dadi_params$species = 'Bacteroides stercoris'
b_thetaiotaomicron_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/inferred_DFE.txt')
b_thetaiotaomicron_dfe_dadi_params$species = 'Bacteroides thetaiotaomicron'
b_uniformis_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_uniformis_57318_downsampled_14/inferred_DFE.txt')
b_uniformis_dfe_dadi_params$species = 'Bacteroides uniformis'
b_vulgatus_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/inferred_DFE.txt')
b_vulgatus_dfe_dadi_params$species = 'Bacteroides vulgatus'
b_xylanisolvens_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/inferred_DFE.txt')
b_xylanisolvens_dfe_dadi_params$species = 'Bacteroides xylanisolvens'
b_intestinihominis_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/inferred_DFE.txt')
b_intestinihominis_dfe_dadi_params$species = 'Barnesiella intestinihominis'
d_invisus_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Dialister_invisus_61905_downsampled_14/inferred_DFE.txt')
d_invisus_dfe_dadi_params$species = 'Dialister invisus'
e_eligens_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Eubacterium_eligens_61678_downsampled_14/inferred_DFE.txt')
e_eligens_dfe_dadi_params$species = 'Eubacterium eligens'
e_rectale_dfe_dadi_params = read_dfe_dadi_params('../Analysis/Eubacterium_rectale_56927_downsampled_14/inferred_DFE.txt')
e_rectale_dfe_dadi_params$species = 'Eubacterium rectale'
phylogenetic_levels = c(
'Akkermansia muciniphila',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes putredinis',
'Alistipes shahii',
'Bacteroidales bacterium',
'Bacteroides caccae',
'Bacteroides cellulosilyticus',
'Bacteroides fragilis',
# 'Bacteroides ovatus',
'Bacteroides stercoris',
'Bacteroides thetaiotaomicron',
'Bacteroides uniformis',
'Bacteroides vulgatus',
'Bacteroides xylanisolvens',
'Barnesiella intestinihominis',
'Odoribactersplanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Eubacterium eligens',
'Eubacterium rectale',
'Faecalibacterium prausnitzii',
'Ruminococcus bicirculans',
'Ruminococcus bromii',
'Oscillibacter species',
# 'Dialister invisus',
'Phascolarctobacterium species')
# dfe_df$value = dfe_df$value * 2
dfe_df$value[dfe_df$value <= 1e-12] = 1e-12
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
dfe_dadi_df$value[dfe_dadi_df$value <= 1e-1] = 1e-1
dfe_df = rbind(
melt(a_muciniphila_dfe_params),
melt(a_finegoldii_dfe_params),
melt(a_onderdonkii_dfe_params),
melt(a_putredinis_dfe_params),
melt(a_shahii_dfe_params),
melt(b_bacterium_dfe_params),
melt(b_caccae_dfe_params),
melt(b_cellulosilyticus_dfe_params),
melt(b_fragilis_dfe_params),
# melt(b_ovatus_dfe_params),
melt(b_stercoris_dfe_params),
melt(b_thetaiotaomicron_dfe_params),
# melt(b_uniformis_dfe_params),
melt(b_vulgatus_dfe_params),
melt(b_xylanisolvens_dfe_params),
melt(b_intestinihominis_dfe_params),
# melt(d_invisus_dfe_params),
melt(e_eligens_dfe_params),
melt(e_rectale_dfe_params),
melt(f_prausnitzii_dfe_params),
melt(o_splanchnicus_dfe_params),
melt(o_sp_dfe_params),
melt(p_distasonis_dfe_params),
melt(p_merdae_dfe_params),
melt(p_sp_dfe_params),
melt(p_copri_dfe_params),
melt(r_bicirculans_dfe_params),
melt(r_bromii_dfe_params)
)
dfe_dadi_df = rbind(
melt(a_muciniphila_dfe_dadi_params),
melt(a_finegoldii_dfe_dadi_params),
melt(a_onderdonkii_dfe_dadi_params),
melt(a_putredinis_dfe_dadi_params),
melt(a_shahii_dfe_dadi_params),
melt(b_bacterium_dfe_dadi_params),
melt(b_caccae_dfe_dadi_params),
melt(b_cellulosilyticus_dfe_dadi_params),
melt(b_fragilis_dfe_dadi_params),
# melt(b_ovatus_dfe_dadi_params),
melt(b_stercoris_dfe_dadi_params),
melt(b_thetaiotaomicron_dfe_dadi_params),
# melt(b_uniformis_dfe_dadi_params),
melt(b_vulgatus_dfe_dadi_params),
melt(b_xylanisolvens_dfe_dadi_params),
melt(b_intestinihominis_dfe_dadi_params),
# melt(d_invisus_dfe_dadi_params),
melt(e_eligens_dfe_dadi_params),
melt(e_rectale_dfe_dadi_params),
melt(f_prausnitzii_dfe_dadi_params),
melt(o_splanchnicus_dfe_dadi_params),
melt(o_sp_dfe_dadi_params),
melt(p_distasonis_dfe_dadi_params),
melt(p_merdae_dfe_dadi_params),
melt(p_sp_dfe_dadi_params),
melt(p_copri_dfe_dadi_params),
melt(r_bicirculans_dfe_dadi_params),
melt(r_bromii_dfe_dadi_params)
)
unique(dfe_df$species)
temp = unique(dfe_df$species)
temp %in% phylogenetic_levels
phylogenetic_levels = c(
'Akkermansia muciniphila',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes putredinis',
'Alistipes shahii',
'Bacteroidales bacterium',
'Bacteroides caccae',
'Bacteroides cellulosilyticus',
'Bacteroides fragilis',
# 'Bacteroides ovatus',
'Bacteroides stercoris',
'Bacteroides thetaiotaomicron',
'Bacteroides uniformis',
'Bacteroides vulgatus',
'Bacteroides xylanisolvens',
'Barnesiella intestinihominis',
'Odoribacter splanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Eubacterium eligens',
'Eubacterium rectale',
'Faecalibacterium prausnitzii',
'Ruminococcus bicirculans',
'Ruminococcus bromii',
'Oscillibacter species',
# 'Dialister invisus',
'Phascolarctobacterium species')
temp %in% phylogenetic_levels
length(temp)
dfe_df$species = factor(dfe_df$species, levels=phylogenetic_levels)
dfe_df
12
# dfe_df$value = dfe_df$value * 2
dfe_df$value[dfe_df$value <= 1e-12] = 1e-12
dfe_df$value[dfe_df$value >= 1] = 1
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'gamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_low', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=4.08E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_df[dfe_df$variable == 'neugamma_dfe_dist_high', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Assuming a mutation rate of mu=6.93E-10'
) +
theme_ridges() +
scale_x_log10(limits=c(1e-13, 1e2)) +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
dfe_dadi_df$value[dfe_dadi_df$value <= 1e-1] = 1e-1
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'gamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
ggplot(dfe_dadi_df[dfe_dadi_df$variable == 'neugamma_dfe_dist', ], aes(x=value, y=fct_rev(species), fill=species)) +
geom_density_ridges2(aes(fill = species), stat = "binline", binwidth = 1, scale = 0.95) +
labs(
title = 'Neutral + Gamma-Distributed DFE',
subtitle = 'Selective effect multiplied by 2N_anc'
) +
theme_ridges() +
scale_x_log10() +
theme(axis.title.y = element_blank()) +
theme(legend.position = "none") +
xlab('Selective Effect')
demography_df$species
demography_df$species = factor(demography_df$species, levels=phylogenetic_levels)
demography_df_highlight = demography_df[demography_df$species %in% c('Odoribacter splanchnicus', 'Eubacterium eligens', 'Bacteroides cellulosilyticus'), ]
ggscatter(demography_df, x="nu", y="time_low", color="species", shape='demography', size=3) + geom_vline(xintercept=1) +
ylab('Estimated Time in Years') +
xlab('Ratio of current to ancestral population size') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
theme(legend.position="right") +
geom_text_repel(aes(label = demography_df$species, color=demography_df$species)) +
guides(color=guide_legend(title="Species")) +
scale_x_log10(limits=c(1e-1, 1e1)) +
scale_y_log10(limits=c(1e1, 1e7)) +
theme(legend.title = element_text(size=30)) +
theme(legend.text = element_text(size=12)) +
guides(color = 'none') +
guides(shape = 'none')  +
geom_point(data=demography_df_highlight, color='red', shape=1, size=6) +
# geom_point(data=demography_df_highlight, aes(x=nu, y=time_low, color='red', shape=1, size=4))  +
ggtitle('Commensal Gut Microbiota have Varied Demographic Histories') +
theme(axis.text=element_text(size=14),
axis.title=element_text(size=16,face="bold"))
