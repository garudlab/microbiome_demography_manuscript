confidence_interval <- c(lower_quantile, upper_quantile))
lower_quantile
upper_quantile
# Given LRS
lrs <- -3
# Degrees of freedom
df <- 2
# Calculate the p-value
p_value <- pchisq(lrs, df, lower.tail = TRUE)
# Significance level for a 95% confidence interval
alpha <- 0.05
# Check if the p-value is less than or equal to the significance level
if (p_value <= alpha) {
cat("The LRS of", lrs, "corresponds to a 95% confidence interval.\n")
} else {
cat("The LRS of", lrs, "does not correspond to a 95% confidence interval.\n")
}
# Print the calculated p-value
cat("Calculated p-value:", p_value, "\n")
?pchisq
mean(pchisq(0.95, df=2))
pchisq(0.95, df=2)
log(-3)
log(3)
pchisq(3, df=2)
pchisq(0.95,df=2)
pchisq(1.1, df=2)
qchisq(1.1, df=2)
qchisq(0.95, df=2)
qchisq(0.95, df=2) / 2
1 - 0.00014245014
qchisq(0.9998575, df=2)
sum(dfe_comparison_matrix>-3)
sum(dfe_comparison_matrix<-3)
dfe_comparison_matrix
dfe_comparison_matrix
# write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
dfe_comparison_matrix
sum(dfe_comparison_matrix < -3)
dfe_comparison_matrix
dfe_comparison_matrix<  -3
# write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
dfe_comparison_matrix = dfe_comparison_matrix[, -1]
# write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
dfe_comparison_matrix = dfe_comparison_matrix[, -1]
rownames(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
sum(dfe_comparison_matrix<-17.71234)
sum(dfe_comparison_matrix < -17.71234)
# write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
# write.csv(dfe_constant_s_matrix, '../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv')
dfe_comparison_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_matrix.csv', header=TRUE)
dfe_comparison_matrix
rownames(dfe_comparison_matrix) = phylogenetic_levels
colnames(dfe_comparison_matrix) = phylogenetic_levels
dfe_comparison_matrix
sum(dfe_comparison_matrix < -17.71234)
sum(dfe_comparison_matrix < -17.71234) / 2
dfe_constant_s_matrix = read.csv('../Analysis/cross_species_dfe/dfe_comparison_constant_s_matrix.csv', header=TRUE)
dfe_constant_s_matrix = dfe_constant_s_matrix[, -1]
rownames(dfe_constant_s_matrix) = phylogenetic_levels
colnames(dfe_constant_s_matrix) = phylogenetic_levels
dfe_constant_s_matrix
sum(dfe_constant_s_matrix < -17.71234) / 2
sum(dfe_comparison_matrix < -17.71234) / 2
core_accessory_comparison =
p25_core_dfe + p25_acc_dfe +
p14_core_dfe + p14_acc_dfe +
p13_core_dfe + p13_acc_dfe +
p15_core_dfe + p15_acc_dfe +
p17_core_dfe + p17_acc_dfe +
p21_core_dfe + p21_acc_dfe +
p22_core_dfe + p22_acc_dfe +
plot_layout(ncol=1)
core_accessory_comparison
core_accessory_comparison =
p14_core_dfe + p14_acc_dfe +
p13_core_dfe + p13_acc_dfe +
p21_core_dfe + p21_acc_dfe +
p22_core_dfe + p22_acc_dfe +
plot_layout(ncol=1)
core_accessory_comparison
species_subtree = c(
# 'Akkermansia_muciniphila_55290',
# 'Alistipes_finegoldii_56071',
# 'Alistipes_onderdonkii_55464',
# 'Alistipes_putredinis_61533',
# 'Alistipes_shahii_62199',
# 'Bacteroidales_bacterium_58650',
# 'Bacteroides_caccae_53434',
# 'Bacteroides_cellulosilyticus_58046',
# 'Bacteroides_fragilis_54507',
# # 'Bacteroides_massiliensis_44749',
# # 'Bacteroides_ovatus_58035',
# 'Bacteroides_stercoris_56735',
'Bacteroides_thetaiotaomicron_56941',
'Bacteroides_uniformis_57318',
# 'Bacteroides_vulgatus_57955',
# 'Bacteroides_xylanisolvens_57185',
# 'Barnesiella_intestinihominis_62208',
# # 'Coprococcus_sp_62244',
# 'Dialister_invisus_61905',
# 'Eubacterium_eligens_61678',
'Eubacterium_rectale_56927',
'Faecalibacterium_prausnitzii_57453',
# 'Odoribacter_splanchnicus_62174',
# 'Oscillibacter_sp_60799',
# 'Parabacteroides_distasonis_56985'
# 'Parabacteroides_merdae_56972',
# 'Phascolarctobacterium_sp_59817',
# 'Prevotella_copri_61740',
# 'Ruminococcus_bicirculans_59300',
# 'Ruminococcus_bromii_62047'
)
species_subtree = c(
# 'Akkermansia_muciniphila_55290',
# 'Alistipes_finegoldii_56071',
# 'Alistipes_onderdonkii_55464',
# 'Alistipes_putredinis_61533',
# 'Alistipes_shahii_62199',
# 'Bacteroidales_bacterium_58650',
# 'Bacteroides_caccae_53434',
# 'Bacteroides_cellulosilyticus_58046',
# 'Bacteroides_fragilis_54507',
# # 'Bacteroides_massiliensis_44749',
# # 'Bacteroides_ovatus_58035',
# 'Bacteroides_stercoris_56735',
'Bacteroides_thetaiotaomicron_56941',
'Bacteroides_uniformis_57318',
# 'Bacteroides_vulgatus_57955',
# 'Bacteroides_xylanisolvens_57185',
# 'Barnesiella_intestinihominis_62208',
# # 'Coprococcus_sp_62244',
# 'Dialister_invisus_61905',
# 'Eubacterium_eligens_61678',
'Eubacterium_rectale_56927',
'Faecalibacterium_prausnitzii_57453'
# 'Odoribacter_splanchnicus_62174',
# 'Oscillibacter_sp_60799',
# 'Parabacteroides_distasonis_56985'
# 'Parabacteroides_merdae_56972',
# 'Phascolarctobacterium_sp_59817',
# 'Prevotella_copri_61740',
# 'Ruminococcus_bicirculans_59300',
# 'Ruminococcus_bromii_62047'
)
midas_code_subtree = c()
for (species in species_subtree) {
midas_code_subtree = c(midas_code_subtree, get_species_code_reference(species, output_table))
}
print(midas_code_subtree)
subtree_tips = midas_code_subtree
# Extract the subtree
subtree <- keep.tip(input_tree, subtree_tips)
# Print the extracted subtree
print(subtree)
for (i in 1:length(subtree$tip.label)) {
print(subtree$tip.label[i])
new_tip = get_species_code_reference(subtree$tip.label[i], output_table)
# new_tip = str_sub(new_tip, 1, str_length(new_tip)-6)
subtree$tip.label[i] = new_tip
print(subtree$tip.label[i])
}
plot(subtree)
write.tree(subtree, file='../Summary/core_accessory.newick')
core_accessory_comparison =
p14a + p14_l_accessory + p14_core_dfe + p14_acc_dfe +
p13a + p13_l_accessory + p13_core_dfe + p13_acc_dfe +
p21a + p21_l_accessory + p21_core_dfe + p21_acc_dfe +
p22a + p22_l_accessory + p22_core_dfe + p22_acc_dfe +
plot_layout(ncol=4)
core_accessory_comparison
?area
design = "ABC
ABD
EFG
EFH
IJK
IJL
MNO
MNP"
core_accessory_comparison =
p14a + p14_l_accessory + p14_core_dfe + p14_acc_dfe +
p13a + p13_l_accessory + p13_core_dfe + p13_acc_dfe +
p21a + p21_l_accessory + p21_core_dfe + p21_acc_dfe +
p22a + p22_l_accessory + p22_core_dfe + p22_acc_dfe +
plot_layout(design=design)
core_accessory_comparison
design = "ABCC
ABDD
EFGG
EFHH
IJKK
IJLL
MNOO
MNPP"
core_accessory_comparison =
p14a + p14_l_accessory + p14_core_dfe + p14_acc_dfe +
p13a + p13_l_accessory + p13_core_dfe + p13_acc_dfe +
p21a + p21_l_accessory + p21_core_dfe + p21_acc_dfe +
p22a + p22_l_accessory + p22_core_dfe + p22_acc_dfe +
plot_layout(design=design)
core_accessory_comparison
p12_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. stercoris, Core Genes')
p13_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
p1_core_dfe = plot_core_accessory_dfe('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. muciniphila, Core Genes')
p2_core_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_finegoldii_56071_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. finegoldii, Core Genes')
p3_core_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. onderdonkii, Core Genes')
p4_core_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_putredinis_61533_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. putredinis, Core Genes')
p5_core_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_shahii_62199_downsampled_14/core_inferred_DFE.txt') + ggtitle('A. shahii, Core Genes')
p6_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. bacterium, Core Genes')
p7_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_caccae_53434_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. caccae, Core Genes')
p8_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. cellulosilyticus, Core Genes')
p9_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_fragilis_54507_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. fragilis, Core Genes')
# p10 = plot_core_accessory_dfe('../Analysis/Bacteroides_massiliensis_44749_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. massiliensis, Core Genes')
p11_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_ovatus_58035_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. ovatus, Core Genes')
p12_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_stercoris_56735_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. stercoris, Core Genes')
p13_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
p14_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_uniformis_57318_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
p15_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. vulgatus, Core Genes')
p16_core_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. xylanisolvens, Core Genes')
p17_core_dfe = plot_core_accessory_dfe('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/core_inferred_DFE.txt') + ggtitle('B. intestinihominis, Core Genes')
# p18 = plot_core_accessory_dfe('../Analysis/Coprococcus_sp_62244_downsampled_14/core_inferred_DFE.txt') + ggtitle('Coprococcus species, Core Genes')
p19_core_dfe = plot_core_accessory_dfe('../Analysis/Dialister_invisus_61905_downsampled_14/core_inferred_DFE.txt') + ggtitle('D. invisus, Core Genes')
p20_core_dfe = plot_core_accessory_dfe('../Analysis/Eubacterium_eligens_61678_downsampled_14/core_inferred_DFE.txt') + ggtitle('E. eligens, Core Genes')
p21_core_dfe = plot_core_accessory_dfe('../Analysis/Eubacterium_rectale_56927_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
p22_core_dfe = plot_core_accessory_dfe('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/core_inferred_DFE.txt') + ggtitle('Core Genes')
p23_core_dfe = plot_core_accessory_dfe('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/core_inferred_DFE.txt') + ggtitle('O. splanchnicus, Core Genes')
p24_core_dfe = plot_core_accessory_dfe('../Analysis/Oscillibacter_sp_60799_downsampled_14/core_inferred_DFE.txt') + ggtitle('Oscillibacter species, Core Genes')
p25_core_dfe = plot_core_accessory_dfe('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/core_inferred_DFE.txt') + ggtitle('P. distasonis, Core Genes')
p26_core_dfe = plot_core_accessory_dfe('../Analysis/Parabacteroides_merdae_56972_downsampled_14/core_inferred_DFE.txt') + ggtitle('P. merdae, Core Genes')
p27_core_dfe = plot_core_accessory_dfe('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/core_inferred_DFE.txt') + ggtitle('Phascolarctobacterium species, Core Genes')
p28_core_dfe = plot_core_accessory_dfe('../Analysis/Prevotella_copri_61740_downsampled_14/core_inferred_DFE.txt') + ggtitle('P.  copri, Core Genes')
p29_core_dfe = plot_core_accessory_dfe('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/core_inferred_DFE.txt') + ggtitle('R. bicirculans, Core Genes')
p30_core_dfe = plot_core_accessory_dfe('../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_inferred_DFE.txt') + ggtitle('R.  bromii, Core Genes')
p1_acc_dfe = plot_core_accessory_dfe('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. muciniphila, Accessory Genes')
p2_acc_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_finegoldii_56071_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. finegoldii, Accessory Genes')
p3_acc_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_onderdonkii_55464_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. onderdonkii, Accessory Genes')
p4_acc_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_putredinis_61533_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. putredinis, Accessory Genes')
p5_acc_dfe = plot_core_accessory_dfe('../Analysis/Alistipes_shahii_62199_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('A. shahii, Accessory Genes')
p6_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroidales_bacterium_58650_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. bacterium, Accessory Genes')
p7_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_caccae_53434_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. caccae, Accessory Genes')
p8_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_cellulosilyticus_58046_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. cellulosilyticus, Accessory Genes')
p9_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_fragilis_54507_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. fragilis, Accessory Genes')
# p10 = plot_core_accessory_dfe('../Analysis/Bacteroides_massiliensis_44749_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. massiliensis, Accessory Genes')
p11_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_ovatus_58035_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. ovatus, Accessory Genes')
p12_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_stercoris_56735_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. stercoris, Accessory Genes')
p13_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_thetaiotaomicron_56941_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Accessory Genes')
p14_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_uniformis_57318_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Accessory Genes')
p15_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_vulgatus_57955_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. vulgatus, Accessory Genes')
p16_acc_dfe = plot_core_accessory_dfe('../Analysis/Bacteroides_xylanisolvens_57185_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. xylanisolvens, Accessory Genes')
p17_acc_dfe = plot_core_accessory_dfe('../Analysis/Barnesiella_intestinihominis_62208_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('B. intestinihominis, Accessory Genes')
# p18 = plot_core_accessory_dfe('../Analysis/Coprococcus_sp_62244_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Coprococcus species, Accessory Genes')
p19_acc_dfe = plot_core_accessory_dfe('../Analysis/Dialister_invisus_61905_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('D. invisus, Accessory Genes')
p20_acc_dfe = plot_core_accessory_dfe('../Analysis/Eubacterium_eligens_61678_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('E. eligens, Accessory Genes')
p21_acc_dfe = plot_core_accessory_dfe('../Analysis/Eubacterium_rectale_56927_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Accessory Genes')
p22_acc_dfe = plot_core_accessory_dfe('../Analysis/Faecalibacterium_prausnitzii_57453_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Accessory Genes')
p23_acc_dfe = plot_core_accessory_dfe('../Analysis/Odoribacter_splanchnicus_62174_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('O. splanchnicus, Accessory Genes')
p24_acc_dfe = plot_core_accessory_dfe('../Analysis/Oscillibacter_sp_60799_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Oscillibacter species, Accessory Genes')
p25_acc_dfe = plot_core_accessory_dfe('../Analysis/Parabacteroides_distasonis_56985_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('P. distasonis, Accessory Genes')
p26_acc_dfe = plot_core_accessory_dfe('../Analysis/Parabacteroides_merdae_56972_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('P. merdae, Accessory Genes')
p27_acc_dfe = plot_core_accessory_dfe('../Analysis/Phascolarctobacterium_sp_59817_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('Phascolarctobacterium species, Accessory Genes')
p28_acc_dfe = plot_core_accessory_dfe('../Analysis/Prevotella_copri_61740_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('P. copri, Accessory Genes')
p29_acc_dfe = plot_core_accessory_dfe('../Analysis/Ruminococcus_bicirculans_59300_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('R. bicirculans, Accessory Genes')
p30_acc_dfe = plot_core_accessory_dfe('../Analysis/Ruminococcus_bromii_62047_downsampled_14/accessory_inferred_DFE.txt') + ggtitle('R. bromii, Accessory Genes')
design = "ABCC
ABDD
EFGG
EFHH
IJKK
IJLL
MNOO
MNPP"
core_accessory_comparison =
p14a + p14_l_accessory + p14_core_dfe + p14_acc_dfe +
p13a + p13_l_accessory + p13_core_dfe + p13_acc_dfe +
p21a + p21_l_accessory + p21_core_dfe + p21_acc_dfe +
p22a + p22_l_accessory + p22_core_dfe + p22_acc_dfe +
plot_layout(design=design)
core_accessory_comparison
two_epoch_nu_tau = read.csv('../Summary/two_epoch_demography_interpretation.csv')
three_epoch_nu_tau= read.csv('../Summary/three_epoch_demography_interpretation.csv')
two_epoch_nu_tau$demography = 'Two Epoch'
three_epoch_nu_tau$demography = 'Three Epoch'
three_epoch_nu_tau = three_epoch_nu_tau[-c(2,4:7)]
colnames(three_epoch_nu_tau) = c('species', 'nu', 'time_low', 'time_high', 'demography')
# demography_df =  rbind(two_epoch_nu_tau, three_epoch_nu_tau)
demography_df = rbind(two_epoch_nu_tau)
demography_df$species = factor(demography_df$species, levels=phylogenetic_levels)
temp_demography_df = demography_df
temp_demography_df$species = factor(demography_df$species, levels=all_genes_demography_df$species)
temp_demography_df = na.omit(temp_demography_df)
temp_demography_df <- temp_demography_df[order(temp_demography_df$species), ]
row.names(temp_demography_df) = NULL
temp_demography_df$species
all_genes_demography_df$species
species_highlight = c('Akkermansia muciniphila', 'Ruminococcus bromii')
typeface = ifelse(demography_df$species %in% species_highlight, 5, 4)
demography_df_highlight = demography_df[demography_df$species %in% species_highlight, ]
options(ggrepel.max.overlaps = Inf)
x_label_text = expression(nu == frac(N[current], N[ancestral]))
demography_scatter = ggscatter(demography_df, x="nu", y="time_low", color="species", shape=18, size=4) +
ylab('Estimated time in years since most recent demographic event') +
xlab(x_label_text) +
geom_vline(xintercept=1.0, color='red', linewidth=1, linetype='dashed') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=typeface) +
guides(color=guide_legend(title="Species")) +
scale_x_log10(limits=c(1e-2, 2e4)) +
scale_y_log10(limits=c(2e2, 5e7)) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none')  +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16))
demography_scatter
demography_scatter = ggscatter(demography_df, x="nu", y="time_low", color="species", shape=18, size=4) +
ylab('Estimated time in years since most recent demographic event') +
xlab(x_label_text) +
geom_vline(xintercept=1.0, color='red', linewidth=1, linetype='dashed') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=typeface) +
guides(color=guide_legend(title="Species")) +
scale_x_log10(limits=c(1e-2, 2e4)) +
scale_y_log10(limits=c(3e2, 5e6)) +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none')  +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16))
demography_scatter
demography_scatter = ggscatter(demography_df, x="nu", y="time_low", color="species", shape=18, size=4) +
ylab('Estimated time in years since most recent demographic event') +
xlab(x_label_text) +
geom_vline(xintercept=1.0, color='red', linewidth=1, linetype='dashed') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=typeface) +
guides(color=guide_legend(title="Species")) +
#scale_x_log10(limits=c(1e-2, 2e4)) +
#scale_y_log10(limits=c(3e2, 5e6)) +
scale_x_log10() +
scale_y_log10() +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none')  +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16))
demography_scatter
demography_df
two_epoch_nu_tau = read.csv('../Summary/two_epoch_demography_interpretation.csv')
three_epoch_nu_tau= read.csv('../Summary/three_epoch_demography_interpretation.csv')
two_epoch_nu_tau$demography = 'Two Epoch'
three_epoch_nu_tau$demography = 'Three Epoch'
two_epoch_nu_tau
two_epoch_nu_tau = two_epoch_nu_tau[-c(10)]
two_epoch_nu_tau
two_epoch_nu_tau = two_epoch_nu_tau[-c(10), ]
two_epoch_nu_tau
three_epoch_nu_tau = three_epoch_nu_tau[-c(2,4:7)]
colnames(three_epoch_nu_tau) = c('species', 'nu', 'time_low', 'time_high', 'demography')
# demography_df =  rbind(two_epoch_nu_tau, three_epoch_nu_tau)
demography_df = rbind(two_epoch_nu_tau)
demography_df$species = factor(demography_df$species, levels=phylogenetic_levels)
temp_demography_df = demography_df
temp_demography_df$species = factor(demography_df$species, levels=all_genes_demography_df$species)
temp_demography_df = na.omit(temp_demography_df)
temp_demography_df <- temp_demography_df[order(temp_demography_df$species), ]
row.names(temp_demography_df) = NULL
temp_demography_df$species
all_genes_demography_df$species
species_highlight = c('Akkermansia muciniphila', 'Ruminococcus bromii')
typeface = ifelse(demography_df$species %in% species_highlight, 5, 4)
demography_df_highlight = demography_df[demography_df$species %in% species_highlight, ]
options(ggrepel.max.overlaps = Inf)
x_label_text = expression(nu == frac(N[current], N[ancestral]))
demography_scatter = ggscatter(demography_df, x="nu", y="time_low", color="species", shape=18, size=4) +
ylab('Estimated time in years since most recent demographic event') +
xlab(x_label_text) +
geom_vline(xintercept=1.0, color='red', linewidth=1, linetype='dashed') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=typeface) +
guides(color=guide_legend(title="Species")) +
#scale_x_log10(limits=c(1e-2, 2e4)) +
#scale_y_log10(limits=c(3e2, 5e6)) +
scale_x_log10() +
scale_y_log10() +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none')  +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16))
demography_scatter
demography_df
two_epoch_nu_tau = read.csv('../Summary/two_epoch_demography_interpretation.csv')
two_epoch_nu_tau
two_epoch_nu_tau$demography = 'Two Epoch'
three_epoch_nu_tau$demography = 'Three Epoch'
two_epoch_nu_tau
three_epoch_nu_tau = three_epoch_nu_tau[-c(2,4:7)]
# demography_df =  rbind(two_epoch_nu_tau, three_epoch_nu_tau)
demography_df = rbind(two_epoch_nu_tau)
phylogenetic_levels
demography_df$species = factor(demography_df$species, levels=phylogenetic_levels)
temp_demography_df = demography_df
temp_demography_df$species = factor(demography_df$species, levels=all_genes_demography_df$species)
temp_demography_df = na.omit(temp_demography_df)
temp_demography_df <- temp_demography_df[order(temp_demography_df$species), ]
row.names(temp_demography_df) = NULL
temp_demography_df$species
all_genes_demography_df$species
phylogenetic_levels = c(
'Bacteroidales bacterium',
'Alistipes putredinis',
'Alistipes finegoldii',
'Alistipes onderdonkii',
'Alistipes shahii',
'Odoribacter splanchnicus',
'Parabacteroides distasonis',
'Parabacteroides merdae',
'Prevotella copri',
'Bacteroides fragilis',
'Bacteroides cellulosilyticus',
'Bacteroides stercoris',
'Bacteroides uniformis',
'Bacteroides thetaiotaomicron',
# 'Bacteroides ovatus',
'Bacteroides xylanisolvens',
'Bacteroides caccae',
# 'Bacteroides massiliensis',
'Bacteroides vulgatus',
'Barnesiella intestinihominis',
'Akkermansia muciniphila',
'Dialister invisus',
'Phascolarctobacterium species',
'Eubacterium eligens',
'Eubacterium rectale',
# 'Coprococcus species',
'Oscillibacter species',
'Ruminococcus bromii',
'Ruminococcus bicirculans',
'Faecalibacterium prausnitzii'
)
two_epoch_nu_tau$demography = 'Two Epoch'
three_epoch_nu_tau$demography = 'Three Epoch'
two_epoch_nu_tau = two_epoch_nu_tau[-c(10), ]
three_epoch_nu_tau = three_epoch_nu_tau[-c(2,4:7)]
colnames(three_epoch_nu_tau) = c('species', 'nu', 'time_low', 'time_high', 'demography')
# demography_df =  rbind(two_epoch_nu_tau, three_epoch_nu_tau)
demography_df = rbind(two_epoch_nu_tau)
demography_df$species = factor(demography_df$species, levels=phylogenetic_levels)
temp_demography_df = demography_df
temp_demography_df$species = factor(demography_df$species, levels=all_genes_demography_df$species)
temp_demography_df = na.omit(temp_demography_df)
temp_demography_df <- temp_demography_df[order(temp_demography_df$species), ]
row.names(temp_demography_df) = NULL
temp_demography_df$species
all_genes_demography_df$species
species_highlight = c('Akkermansia muciniphila', 'Ruminococcus bromii')
typeface = ifelse(demography_df$species %in% species_highlight, 5, 4)
demography_df_highlight = demography_df[demography_df$species %in% species_highlight, ]
options(ggrepel.max.overlaps = Inf)
x_label_text = expression(nu == frac(N[current], N[ancestral]))
demography_scatter = ggscatter(demography_df, x="nu", y="time_low", color="species", shape=18, size=4) +
ylab('Estimated time in years since most recent demographic event') +
xlab(x_label_text) +
geom_vline(xintercept=1.0, color='red', linewidth=1, linetype='dashed') +
scale_shape_manual(name = "Best-Fit Demographic Model",
labels = c("Three Epoch", "Two Epoch"),
values = c(17, 19)) +
geom_text_repel(aes(label = species, color=species, fontface = 'italic'), size=typeface) +
guides(color=guide_legend(title="Species")) +
#scale_x_log10(limits=c(1e-2, 2e4)) +
#scale_y_log10(limits=c(3e2, 5e6)) +
scale_x_log10() +
scale_y_log10() +
theme(legend.position = 'none') +
guides(color = 'none') +
guides(shape = 'none')  +
theme(axis.text=element_text(size=12),
axis.title=element_text(size=16))
demography_scatter
design = c(
area(1, 1, 1, 1),
area(1, 2, 1, 2),
area(2, 1, 2, 1),
area(2, 2, 2, 2),
area(1, 3, 2, 6)
#area(3, 3, 6, 4),
#area(3, 5, 6, 6)
)
p1 = plot_best_fit_sfs_3A(a_muciniphila_best_fit) + ggtitle('Akkermansia muciniphila')
p1_l = plot_likelihood_surface_contour_3C('../Analysis/Akkermansia_muciniphila_55290_downsampled_14/core_likelihood_surface.csv')
p30 = plot_best_fit_sfs_3B(r_bromii_best_fit) + ggtitle('Ruminococcus bromii')
p30_l = plot_likelihood_surface_contour_3D('../Analysis/Ruminococcus_bromii_62047_downsampled_14/core_likelihood_surface.csv')
# 2000 x 900
p1 + p1_l + # A. muciniphila
p30 + p30_l + #R. bicirculans
demography_scatter +
plot_layout(design=design)
